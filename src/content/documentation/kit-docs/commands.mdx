import Section from '@components/markdown/Section.astro';
import Tab from '@components/markdown/Tab.astro';
import Tabs from '@components/markdown/Tabs.astro';
import Callout from '@components/markdown/Callout.astro';
import Button from '@components/markdown/Button.astro';

# å‘½ä»¤åˆ—è¡¨

## ç”Ÿæˆè¿ç§»

`drizzle-kit generate` å…è®¸ä½ æ ¹æ®ä½ çš„ Drizzle æ¶æ„ç”Ÿæˆè¿ç§»ã€‚

| å‚æ•°                                        | å¿…å¡«    | æè¿°                                                         |
| :------------------------------------------ | :------ | :----------------------------------------------------------- |
| **`dialect`**   | æ˜¯       | ä½ æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æ–¹è¨€ã€‚å¯ä»¥æ˜¯ `postgresql`ã€`mysql` æˆ– `sqlite` |
| **[`schema`](/kit-docs/conf#schema-files-paths)**   | æ˜¯       | TypeScript æ¶æ„æ–‡ä»¶æˆ–åŒ…å«å¤šä¸ªæ¶æ„æ–‡ä»¶çš„æ–‡ä»¶å¤¹çš„è·¯å¾„               |
| **[`out`](/kit-docs/conf#migrations-folder)**      | å¦       | è¿ç§»æ–‡ä»¶å¤¹ï¼Œé»˜è®¤=`./drizzle`                                   |
| `config`                                  | å¦       | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤=`drizzle.config.ts`                           |
| `custom`                                  | å¦       | ä¸ºè‡ªå®šä¹‰è¿ç§»ç”Ÿæˆç©ºçš„ SQL                                          |
| `name`                                  | å¦       | ç”Ÿæˆå…·æœ‰è‡ªå®šä¹‰åç§°çš„è¿ç§»                                          |
| **[`breakpoints`](/kit-docs/conf#sql-breakpoints)** | å¦       | SQL è¯­å¥æ–­ç‚¹ï¼Œé»˜è®¤=`true`                                        |

<Section>
```shell
$ drizzle-kit generate
```
```ts
// drizzle.config.ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "postgresql", // "mysql" | "sqlite"
  schema: "./src/schema.ts",
  out: "./drizzle",
});
```
</Section>

å¦‚æœä½ æƒ³ä¸ºè¿ç§»ä½¿ç”¨è‡ªå®šä¹‰åç§°

```shell
$ drizzle-kit generate --name init_db
```

å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå®šä¹‰å‘½åçš„é…ç½®æ–‡ä»¶

```shell
$ drizzle-kit generate --config=custom.config.ts
```

å¦‚æœä½ æƒ³å°†æ‰€æœ‰å‚æ•°ä½œä¸º CLI é€‰é¡¹

```shell
$ drizzle-kit generate --schema=./src/schema.ts --out=./drizzle
```

ä¸ºè‡ªå®šä¹‰è¿ç§»ç”Ÿæˆä¸€ä¸ªç©ºçš„ SQL è¿ç§»æ–‡ä»¶ã€‚

```shell
$ drizzle-kit generate --custom
```

## åº”ç”¨è¿ç§»

`drizzle-kit migrate` å…è®¸ä½ åº”ç”¨å­˜å‚¨åœ¨è¿ç§»æ–‡ä»¶å¤¹ä¸­çš„è¿ç§»ï¼Œå¹¶è¾“å‡ºç”± `drizzle-kit generate` ç”Ÿæˆçš„è¿ç§»ã€‚

| å‚æ•°                                        | å¿…å¡«    | æè¿°                                                         |
| :------------------------------------------ | :------ | :----------------------------------------------------------- |
| `config`                                  | å¦       | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤=`drizzle.config.ts`                           |

<Section>
```shell
$ drizzle-kit migrate
```
```ts
// drizzle.config.ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "postgresql", // "mysql" | "sqlite"
  out: "./drizzle",
  migrations: {
    table: 'migrations_custom', // é»˜è®¤ä¸º `__drizzle_migrations`,
    schema: 'public', // ä»…åœ¨ PostgreSQL ä¸­ä½¿ç”¨ï¼Œé»˜è®¤ä¸º `drizzle`
  }
});
```
</Section>

å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå®šä¹‰å‘½åçš„é…ç½®æ–‡ä»¶

```shell
$ drizzle-kit migrate --config=custom.config.ts
```

## å†…çœ / æ‹‰å–

`drizzle-kit introspect` å‘½ä»¤å…è®¸ä½ ä»ç°æœ‰æ•°æ®åº“ä¸­æå–DDLå¹¶åœ¨å‡ ç§’é’Ÿå†…ç”Ÿæˆ `schema.ts` æ–‡ä»¶ã€‚

`url` æˆ– `user:password@host:port/db` å‚æ•°æ˜¯å¿…éœ€çš„ã€‚

| å‚æ•°                                        | å¿…å¡«    | æè¿°                                                         |
| :------------------------------------------ | :------ | :----------------------------------------------------------- |
| **`dialect`**   | æ˜¯       | ä½ æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æ–¹è¨€ã€‚å¯ä»¥æ˜¯ `postgresql`ã€`mysql` æˆ– `sqlite` |
| driver                                  | å¦       | ç”¨äºæŸ¥è¯¢çš„é©±åŠ¨ç¨‹åºï¼ˆ`aws-data-api`ã€`d1-http`ã€`turso`ã€`expo`ï¼‰     |
| **[`out`](/kit-docs/conf#migrations-folder)**       | å¦       | è¿ç§»æ–‡ä»¶å¤¹ï¼Œé»˜è®¤=`./drizzle`                                   |
| `url`                              | å¦       | æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²                                                |
| `user`                                        | å¦       | æ•°æ®åº“ç”¨æˆ·                                                    |
| `password`                                    | å¦       | æ•°æ®åº“å¯†ç                                                     |
| `host`                                        | å¦       | ä¸»æœºå                                                         |
| `port`                                        | å¦       | ç«¯å£å·                                                         |
| `database`                                    | å¦       | æ•°æ®åº“åç§°                                                    |
| `config`                                      | å¦       | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤=`drizzle.config.ts`                           |
| `introspect-casing`                           | å¦       | JS é”®åœ¨åˆ—ã€è¡¨ç­‰ä¸­çš„åˆ›å»ºç­–ç•¥ (`preserve`ã€`camel`) 	                    |
| **[`schemaFilter`](/kit-docs/config-reference#schemaFilter)**                              | å¦       | æ¶æ„åç§°ç­›é€‰å™¨ã€‚é»˜è®¤: `["public"]`                   |
| **[`extensionsFilters`](/kit-docs/config-reference#extensionsfilters)** | å¦       | æ•°æ®åº“æ‰©å±•å†…éƒ¨æ•°æ®åº“è¿‡æ»¤å™¨                                                   |


<Section>

```shell
$ drizzle-kit introspect
```

</Section>

<Tabs items={["ç¤ºä¾‹ 1", "ç¤ºä¾‹ 2"]}>
<Tab>
```ts {8}
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  schema: "./src/schema/*",
  out: "./drizzle",
  dialect: 'postgresql',
  dbCredentials: {
    url: "postgresql://postgres:password@host:port/db",
  }
});
```
</Tab>
<Tab>
```ts {8-12}
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  schema: "./src/schema/*",
  out: "./drizzle",
  dialect: 'postgresql',
  dbCredentials: {
    user: "postgres",
    password: "password",
    host: "127.0.0.1",
    port: 5432,
    database: "db",
  }
});
```
</Tab>
</Tabs>

å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå®šä¹‰å‘½åçš„é…ç½®æ–‡ä»¶

```shell
$ drizzle-kit introspect --config=custom.config.ts
```

å¦‚æœä½ æƒ³å°†æ‰€æœ‰å‚æ•°ä½œä¸º CLI é€‰é¡¹

```shell
$ drizzle-kit introspect --out=migrations/ --connectionString=postgresql://user:pass@host:port/db_name
$ drizzle-kit introspect --out=migrations/ --host=0.0.0.0 --port=5432 --user=postgres --password=pass --database=db_name --ssl
```

![](@/assets/gifs/introspect_mysql.gif)

## åŸå‹ / æ¨é€

`drizzle-kit push` å…è®¸ä½ ç›´æ¥å°†æ¶æ„æ›´æ”¹æ¨é€åˆ°æ•°æ®åº“ï¼Œå¹¶çœç•¥ç®¡ç† SQL è¿ç§»æ–‡ä»¶ã€‚

è¿™å¯¹äºå¿«é€Ÿæœ¬åœ°å¼€å‘ï¼ˆåŸå‹è®¾è®¡ï¼‰å’Œä½¿ç”¨è¿œç¨‹æ•°æ®åº“ï¼ˆå¦‚ **[Planetscale](https://planetscale.com/)**ã€**[Neon](https://neon.tech/)**ã€**[Turso](https://turso.tech/drizzle)** ç­‰ï¼‰éå¸¸æœ‰ç”¨ã€‚

<Callout type="info">
  æœ‰å…³ Turso å’Œ drizzle-kit push çš„è¯¦ç»†æ–‡ç«  â€” **[ç‚¹å‡»é˜…è¯»](https://driz.link/sqlite-push)**
</Callout>

`url` æˆ– `user:password@host:port/db` å‚æ•°æ˜¯ **å¿…éœ€** çš„ã€‚

| å‚æ•°                                           | å¿…å¡«    | æè¿°                                                         |
| :--------------------------------------------- | :------ | :----------------------------------------------------------- |
| **`dialect`**   | æ˜¯       | ä½ æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æ–¹è¨€ã€‚å¯ä»¥æ˜¯ `postgresql`ã€`mysql` æˆ– `sqlite` |
| **[`schema`](/kit-docs/conf#schema-files-paths)**             | æ˜¯       | TypeScript æ¶æ„æ–‡ä»¶æˆ–åŒ…å«å¤šä¸ªæ¶æ„æ–‡ä»¶çš„æ–‡ä»¶å¤¹çš„è·¯å¾„            |
| driver                                   | å¦       | ç”¨äºæŸ¥è¯¢çš„é©±åŠ¨ç¨‹åºï¼ˆ`aws-data-api`ã€`d1-http`ã€`turso`ã€`expo`ï¼‰     |
| **[`tablesFilter`](/kit-docs/conf#multi-project-schema)** | å¦       | è¡¨åç­›é€‰å™¨                                                    |
| **[`schemaFilter`](/kit-docs/config-reference#schemafilter)**                                | å¦       | æ¶æ„åç§°ç­›é€‰å™¨ã€‚é»˜è®¤: `["public"]`                   |
| **[`extensionsFilters`](/kit-docs/config-reference#extensionsfilters)** | å¦       | æ•°æ®åº“æ‰©å±•å†…éƒ¨æ•°æ®åº“è¿‡æ»¤å™¨                                                 |
| `url`                               | å¦       | æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²                                                |
| `user`                                         | å¦       | æ•°æ®åº“ç”¨æˆ·                                                    |
| `password`                                     | å¦       | æ•°æ®åº“å¯†ç                                                     |
| `host`                                         | å¦       | ä¸»æœºå                                                         |
| `port`                                         | å¦       | ç«¯å£å·                                                         |
| `database`                                     | å¦       | æ•°æ®åº“åç§°                                                    |
| `config`                                       | å¦       | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤=`drizzle.config.ts`                           |
| `verbose`                                      | å¦       | æ‰“å°å°†è¦æ‰§è¡Œçš„æ‰€æœ‰æŸ¥è¯¢                                          |
| `strict`                                       | å¦       | åœ¨æ¨é€æ¶æ„ä¹‹å‰å§‹ç»ˆè¦æ±‚ç¡®è®¤                                      |
| `force`                                        | å¦       | è‡ªåŠ¨æ¥å—æ‰€æœ‰æ•°æ®ä¸¢å¤±å£°æ˜                 |

<Section>

```shell
$ drizzle-kit push
```

</Section>

å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå®šä¹‰å‘½åçš„é…ç½®æ–‡ä»¶

```shell
$ drizzle-kit push --config=custom.config.ts
```

å¦‚æœä½ æƒ³å°†æ‰€æœ‰å‚æ•°ä½œä¸º CLI é€‰é¡¹

```shell
$ drizzle-kit push --schema=src/schema.ts --url=postgresql://user:pass@host:port/db_name
$ drizzle-kit push --schema=src/schema.ts --host=0.0.0.0 --port=5432 --user=postgres --password=pass --database=db_name --ssl
```

## åˆ é™¤è¿ç§»

`drizzle-kit drop` å…è®¸ä½ ä»è¿ç§»æ–‡ä»¶å¤¹ä¸­åˆ é™¤å…ˆå‰ç”Ÿæˆçš„è¿ç§»

<Callout type="warning" emoji="âš ï¸">
  è¯·ä¸è¦æ‰‹åŠ¨åˆ é™¤è¿ç§»æ–‡ä»¶å¤¹ä¸­çš„ä»»ä½•æ–‡ä»¶ï¼Œè¿™å¯èƒ½ä¼šç ´å drizzle-kit
</Callout>

| å‚æ•°                             | å¿…å¡«    | æè¿°                                   |
| :-------------------------------- | :------ | :--------------------------------------- |
| **[`out`](/kit-docs/conf#migrations-folder)** | å¦       | è¿ç§»æ–‡ä»¶å¤¹ï¼Œé»˜è®¤=`./drizzle`             |
| `config`                          | å¦       | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤=`drizzle.config.ts` |

```shell
$ drizzle-kit drop
```

å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå®šä¹‰å‘½åçš„é…ç½®æ–‡ä»¶

```shell
$ drizzle-kit drop --config=custom.config.ts
```

å¦‚æœä½ æƒ³å°†æ‰€æœ‰å‚æ•°ä½œä¸º CLI é€‰é¡¹

```shell
$ drizzle-kit drop --out=drizzle
```

![](@/assets/gifs/drop.gif)


## ç»´æŠ¤è¿‡æ—¶çš„å…ƒæ•°æ®
æˆ‘ä»¬çš„ Drizzle Kit API åœ¨å¿«é€Ÿå‘å±•ï¼Œæœ‰æ—¶éœ€è¦å‡çº§åº•å±‚å…ƒæ•°æ®ç»“æ„ã€‚
`drizzle-kit up` æ˜¯ä¸€ä¸ªå®ç”¨ç¨‹åºå‘½ä»¤ï¼Œç”¨äºä½¿æ‰€æœ‰å…ƒæ•°æ®ä¿æŒæœ€æ–°ã€‚

| å‚æ•°                             | å¿…å¡«    | æè¿°                                   |
| :-------------------------------- | :------ | :--------------------------------------- |
| **`dialect`**   | æ˜¯       | ä½ æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æ–¹è¨€ã€‚å¯ä»¥æ˜¯ `postgresql`ã€`mysql` æˆ– `sqlite` |
| **[`out`](/kit-docs/conf#migrations-folder)** | å¦       | è¿ç§»æ–‡ä»¶å¤¹ï¼Œé»˜è®¤=`./drizzle`             |
| `config`                          | å¦       | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤=`drizzle.config.ts` |

<Section>
```shell
$ drizzle-kit up
```
</Section>

å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå®šä¹‰å‘½åçš„é…ç½®æ–‡ä»¶

```shell
$ drizzle-kit up --config=custom.config.ts
```

å¦‚æœä½ æƒ³å°†æ‰€æœ‰å‚æ•°ä½œä¸º CLI é€‰é¡¹

```shell
$ drizzle-kit up --out=drizzle
```

![](@/assets/gifs/up_mysql.gif)


## æ£€æŸ¥
`drizzle-kit check` æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºæ£€æŸ¥è¿ç§»çš„ä¸€è‡´æ€§ã€‚
å½“ä½ çš„é¡¹ç›®ä¸­æœ‰å¤šä¸ªäººåœ¨ä¸åŒçš„åˆ†æ”¯ä¸Šä¿®æ”¹æ•°æ®åº“æ¶æ„æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚
Drizzle Kit å°†æ£€æŸ¥æ‰€æœ‰å†²çªå’Œä¸ä¸€è‡´ä¹‹å¤„ã€‚

| å‚æ•°                             | å¿…å¡«    | æè¿°                                   |
| :-------------------------------- | :------ | :--------------------------------------- |
| **`dialect`**   | æ˜¯       | ä½ æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æ–¹è¨€ã€‚å¯ä»¥æ˜¯ `postgresql`ã€`mysql` æˆ– `sqlite` |
| **[`out`](/kit-docs/conf#migrations-folder)** | å¦       | è¿ç§»æ–‡ä»¶å¤¹ï¼Œé»˜è®¤=`./drizzle`             |
| `config`                          | å¦       | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤=`drizzle.config.ts` |

<Section>
```shell
$ drizzle-kit check
```
</Section>

å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå®šä¹‰å‘½åçš„é…ç½®æ–‡ä»¶

```shell
$ drizzle-kit check --config=custom.config.ts
```

å¦‚æœä½ æƒ³å°†æ‰€æœ‰å‚æ•°ä½œä¸º CLI é€‰é¡¹

```shell
$ drizzle-kit check --out=drizzle
```

## Drizzle Studio
`drizzle-kit studio` å¯ä»¥ä»é…ç½®æ–‡ä»¶å¯åŠ¨æœ¬åœ° **[Drizzle Studio](/drizzle-studio/overview)** æ•°æ®åº“æµè§ˆå™¨ã€‚

| å‚æ•°     | å¿…å¡«    | æè¿°              |
| :-------- | :------ | :---------------- |
| `port`    | å¦       | è‡ªå®šä¹‰ç«¯å£         |
| `host`    | å¦       | è‡ªå®šä¹‰ Studio æœåŠ¡å™¨ä¸»æœº |
| `verbose` | å¦       | è®°å½•æ‰€æœ‰ SQL è¯­å¥  |

```bash
drizzle-kit studio

drizzle-kit studio --port 3000 --host 0.0.0.0 --verbose
```

<Button href={"https://demo.drizzle.studio"} value="ğŸ–¥ Drizzle Studio æ¼”ç¤º" />

<Button href={"https://local.drizzle.studio"} value="ğŸ–¥ æ‰“å¼€ Drizzle Studio" />