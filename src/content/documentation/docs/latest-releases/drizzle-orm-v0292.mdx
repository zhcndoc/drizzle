---
title: DrizzleORM v0.29.2 å‘å¸ƒ
pubDate: 2023-12-25
description: å®ç°äº† planescale å…³ç³»æµ‹è¯•ä¸­çš„å¢å¼ºã€‚ä¿®æ­£äº†ç©º PgArrays çš„å­—ç¬¦ä¸²è½¬ä¹‰ã€‚çº æ­£äº† SQLite ä¸­ exists å‡½æ•°çš„è¯­æ³•é”™è¯¯ã€‚ç¡®ä¿åœ¨ AWS Data API ä¸­æ­£ç¡®å¤„ç†æ—¥æœŸã€‚è§£å†³äº† Hermes mixins æ„é€ å‡½æ•°é—®é¢˜ã€‚
---

## ä¿®å¤:

- ä¸º planescale å…³ç³»æµ‹è¯•æ·»åŠ äº†æ”¹è¿› ([#1579](https://github.com/drizzle-team/drizzle-orm/pull/1579))
- ä¿®å¤: ä¿®æ­£äº†ç©º PgArrays çš„å­—ç¬¦ä¸²è½¬ä¹‰ ([#1640](https://github.com/drizzle-team/drizzle-orm/pull/1640))
- ä¿®å¤ SQLite ä¸­ exists å‡½æ•°çš„è¯­æ³•é”™è¯¯ ([#1647](https://github.com/drizzle-team/drizzle-orm/pull/1647))
- æ­£ç¡®å¤„ç† AWS Data API ä¸­çš„æ—¥æœŸ
- ä¿®å¤ Hermes mixins æ„é€ å‡½æ•°é—®é¢˜

## ESLint Drizzle æ’ä»¶ï¼Œv0.2.3

```bash copy
npm i eslint-plugin-drizzle@0.2.3
```

ğŸ‰ [ESLint] æ·»åŠ å¯¹å‡½æ•°çš„æ”¯æŒï¼Œå¹¶æ”¹å–„é”™è¯¯ä¿¡æ¯

- å…è®¸ Drizzle å¯¹è±¡ä½œä¸ºå‡½æ•°ä½¿ç”¨æˆ–ä»å‡½æ•°ä¸­æ£€ç´¢ï¼Œä¾‹å¦‚ï¼š
- åœ¨é”™è¯¯ä¿¡æ¯çš„å»ºè®®ä¸­å¢åŠ äº†æ›´å¥½çš„ä¸Šä¸‹æ–‡ã€‚

æ›´å¤šä¿¡æ¯å¯ä»¥æŸ¥çœ‹ [æ–‡æ¡£](/docs/eslint-plugin)
## æ–°é©±åŠ¨

**ğŸ‰ Expo SQLite é©±åŠ¨å·²ä¸Šçº¿**

è¦å¼€å§‹ä½¿ç”¨ [Expo SQLite é©±åŠ¨](/docs/get-started-sqlite#expo-sqlite)ï¼Œæ‚¨éœ€è¦å®‰è£… `expo-sqlite` å’Œ `drizzle-orm` åŒ…ã€‚

```bash copy
npm install drizzle-orm expo-sqlite@next
```

ç„¶åï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·ä½¿ç”¨å®ƒï¼š

```ts copy {4,6}
import { drizzle } from "drizzle-orm/expo-sqlite";
import { openDatabaseSync } from "expo-sqlite/next";

const expoDb = openDatabaseSync("db.db");

const db = drizzle(expoDb);

await db.select().from(...)...

// æˆ–è€…

db.select().from(...).then(...);

// æˆ–è€…

db.select().from(...).all();
```

å¦‚æœæ‚¨æƒ³ä½¿ç”¨ Drizzle Migrationsï¼Œéœ€è¦æ›´æ–° babel å’Œ metro é…ç½®æ–‡ä»¶ã€‚

1. å®‰è£… `babel-plugin-inline-import` åŒ…ã€‚

```bash copy
npm install babel-plugin-inline-import
```

2. æ›´æ–° `babel.config.js` å’Œ `metro.config.js` æ–‡ä»¶ã€‚

```ts filename="babel.config.js" copy {6}
module.exports = function(api) {
  api.cache(true);

  return {
    presets: ['babel-preset-expo'],
+   plugins: [["inline-import", { "extensions": [".sql"] }]]
  };
};
```

```ts filename="metro.config.js" copy {6}
const { getDefaultConfig } = require('expo/metro-config');

/** @type {import('expo/metro-config').MetroConfig} */
const config = getDefaultConfig(__dirname);

+config.resolver.sourceExts.push('sql');

module.exports = config;
```

3. åœ¨æ‚¨çš„é¡¹ç›®æ ¹ç›®å½•ä¸­åˆ›å»º `drizzle.config.ts` æ–‡ä»¶ã€‚

```ts copy
import type { Config } from 'drizzle-kit';

export default {
	schema: './db/schema.ts',
	out: './drizzle',
    dialect: 'sqlite',
	driver: 'expo',
} satisfies Config;
```

åˆ›å»º schema æ–‡ä»¶å’Œ drizzle.config.ts æ–‡ä»¶åï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·ç”Ÿæˆè¿ç§»ï¼š

```bash copy
npx drizzle-kit generate
```

ç„¶åæ‚¨éœ€è¦åœ¨ `App.tsx` æ–‡ä»¶ä¸­ä» `./drizzle` æ–‡ä»¶å¤¹å¯¼å…¥ `migrations.js` æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨é’©å­ `useMigrations` æˆ– `migrate` å‡½æ•°ã€‚

```ts copy {4,11}
import { drizzle } from "drizzle-orm/expo-sqlite";
import { openDatabaseSync } from "expo-sqlite/next";
import { useMigrations } from 'drizzle-orm/expo-sqlite/migrator';
import migrations from './drizzle/migrations';

const expoDb = openDatabaseSync("db.db");

const db = drizzle(expoDb);

export default function App() {
    const { success, error } = useMigrations(db, migrations);

    if (error) {
        return (
            <View>
                <Text>è¿ç§»é”™è¯¯: {error.message}</Text>
            </View>
        );
    }

    if (!success) {
        return (
            <View>
                <Text>è¿ç§»è¿›è¡Œä¸­...</Text>
            </View>
        );
    }

    return ...æ‚¨çš„åº”ç”¨ç»„ä»¶;
}
```
