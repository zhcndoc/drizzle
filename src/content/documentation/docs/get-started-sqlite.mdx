import Npm from "@components/markdown/Npm.astro";
import Callout from '@components/markdown/Callout.astro';
import AnchorCards from '@components/markdown/AnchorCards.astro';
import Steps from '@components/markdown/Steps.astro';

<AnchorCards cards={{
  "Turso": "#turso",
  "Cloudflare D1": "#cloudflare-d1",
  "Bun SQLite": "#bun-sqlite",
  "React Native SQLite": "#react-native-sqlite",
  "Expo SQLite": "#expo-sqlite",
  "better-sqlite3" : "#better-sqlite3",
  "HTTP proxy": "#http-proxy"
}}/>

## Turso

æ ¹æ®å…¶ [å®˜æ–¹ç½‘ç«™](https://turso.tech/drizzle) æè¿°ï¼ŒTurso æ˜¯ä¸€ä¸ªä»¥ [libSQL](https://github.com/libsql/libsql) ä¸ºé©±åŠ¨çš„è¾¹ç¼˜ SQLite æ•°æ®åº“ä½œä¸ºæœåŠ¡ã€‚

Drizzle ORM åŸç”Ÿæ”¯æŒ libSQL é©±åŠ¨ç¨‹åºï¼Œæˆ‘ä»¬é‡‡ç”¨ SQL æ–¹è¨€å’Œæ–¹è¨€ç‰¹å®šçš„é©±åŠ¨ç¨‹åºå’Œè¯­æ³•ï¼Œå¹¶æ¨¡æ‹Ÿæœ€æµè¡Œçš„ç±»ä¼¼ SQLite çš„ `all`ã€`get`ã€`values` å’Œ `run` æŸ¥è¯¢æ–¹æ³•çš„è¯­æ³•ã€‚

<Npm>
drizzle-orm @libsql/client
-D drizzle-kit
</Npm>

```typescript copy
import { drizzle } from 'drizzle-orm/libsql';
import { createClient } from '@libsql/client';

const client = createClient({ url: 'DATABASE_URL', authToken: 'DATABASE_AUTH_TOKEN' });

const db = drizzle(client);

const result = await db.select().from(users).all()
```

é™¤éæ‚¨æ‰“ç®—æ‰‹åŠ¨ç¼–å†™æ¯ä¸ª SQL æŸ¥è¯¢ï¼Œå¦åˆ™è¡¨å£°æ˜éå¸¸æœ‰ç”¨ï¼š
```typescript copy
import { sql } from "drizzle-orm";
import { text, integer, sqliteTable } from "drizzle-orm/sqlite-core";

const users = sqliteTable('users', {
  id: text('id'),
  textModifiers: text('text_modifiers').notNull().default(sql`CURRENT_TIMESTAMP`),
  intModifiers: integer('int_modifiers', { mode: 'boolean' }).notNull().default(false),
});
```
æœ‰å…³åˆ—ç±»å‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [Drizzle ä¸­çš„ SQLite åˆ—ç±»å‹](/docs/column-types/sqlite)ã€‚

## Cloudflare D1

æ ¹æ®å…¶ [å®˜æ–¹ç½‘ç«™](https://developers.cloudflare.com/d1/) æè¿°ï¼ŒD1 æ˜¯ Cloudflare çš„ç¬¬ä¸€ä¸ªå¯æŸ¥è¯¢å…³ç³»æ•°æ®åº“ã€‚

Drizzle ORM å®Œå…¨æ”¯æŒ Cloudflare D1 æ•°æ®åº“å’Œ Cloudflare Workers ç¯å¢ƒã€‚
æˆ‘ä»¬é‡‡ç”¨ SQL æ–¹è¨€å’Œæ–¹è¨€ç‰¹å®šçš„é©±åŠ¨ç¨‹åºå’Œè¯­æ³•ï¼Œå¹¶æ¨¡æ‹Ÿæœ€æµè¡Œçš„ç±»ä¼¼ SQLite çš„ `all`ã€`get`ã€`values` å’Œ `run` æŸ¥è¯¢æ–¹æ³•çš„è¯­æ³•ã€‚

è¦ä¸ºæ‚¨çš„ Cloudflare D1 è®¾ç½®é¡¹ç›®ï¼Œè¯·å‚é˜… [å®˜æ–¹æ–‡æ¡£](https://developers.cloudflare.com/d1/)ã€‚

```toml
### your wrangler.toml will look something like this:

name = "YOUR PROJECT NAME"
main = "src/index.ts"
compatibility_date = "2022-11-07"
node_compat = true

[[ d1_databases ]]
binding = "DB"
database_name = "YOUR DB NAME"
database_id = "YOUR DB ID"
migrations_dir = "drizzle/migrations"
```

åˆå§‹åŒ–æœ¬åœ°æ•°æ®åº“å¹¶åœ¨æœ¬åœ°è¿è¡ŒæœåŠ¡å™¨ï¼š
```bash
wrangler d1 migrations apply <DATABASE_NAME> --local
wrangler dev ## åœ¨ç‰ˆæœ¬ä½äº 3.0.0 çš„ wrangler åŠ ä¸Š --local å’Œ --persist æ ‡å¿—
```

å®‰è£… Drizzle ORMï¼š

<Npm>
drizzle-orm
-D drizzle-kit
</Npm>

è¿›è¡Œç¬¬ä¸€ä¸ª D1 æŸ¥è¯¢ï¼š
```typescript copy
import { drizzle } from 'drizzle-orm/d1';

export interface Env {
  <BINDING_NAME>: D1Database;
}

export default {
  async fetch(request: Request, env: Env) {
    const db = drizzle(env.<BINDING_NAME>);
    const result = await db.select().from(users).all()
    return Response.json(result);
  },
};
```

é™¤éæ‚¨æ‰“ç®—æ‰‹åŠ¨ç¼–å†™æ¯ä¸ª SQL æŸ¥è¯¢ï¼Œå¦åˆ™è¡¨å£°æ˜éå¸¸æœ‰ç”¨ï¼š
```typescript copy
import { sql } from "drizzle-orm";
import { text, integer, sqliteTable } from "drizzle-orm/sqlite-core";

const users = sqliteTable('users', {
  id: text('id'),
  textModifiers: text('text_modifiers').notNull().default(sql`CURRENT_TIMESTAMP`),
  intModifiers: integer('int_modifiers', { mode: 'boolean' }).notNull().default(false),
});
```
æœ‰å…³åˆ—ç±»å‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [Drizzle ä¸­çš„ SQLite åˆ—ç±»å‹](/docs/column-types/sqlite)ã€‚

## Bun SQLite

æ ¹æ®å…¶ [å®˜æ–¹ç½‘ç«™](https://bun.sh/) æè¿°ï¼ŒBun æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„å…¨èƒ½çš„ JavaScript è¿è¡Œæ—¶ã€‚

Drizzle ORM åŸç”Ÿæ”¯æŒ [`bun:sqlite`](https://bun.sh/docs/api/sqlite) æ¨¡å—ï¼Œè€Œä¸”é€Ÿåº¦éå¸¸å¿« ğŸš€

æˆ‘ä»¬é‡‡ç”¨ SQL æ–¹è¨€å’Œæ–¹è¨€ç‰¹å®šçš„é©±åŠ¨ç¨‹åºå’Œè¯­æ³•ï¼Œå¹¶ä¸å…¶ä»–ä»»ä½• ORM ä¸åŒï¼Œ
å¯¹äºåƒæ˜¯ `bun:sqlite` è¿™æ ·çš„åŒæ­¥é©±åŠ¨ç¨‹åºï¼Œæˆ‘ä»¬åŒæ—¶å…·æœ‰ **async** å’Œ **sync** APIï¼Œå¹¶ä¸”æˆ‘ä»¬æ¨¡æ‹Ÿäº†æœ€æµè¡Œçš„ç±»ä¼¼ SQLite çš„ `all`ã€`get`ã€`values` å’Œ `run` æŸ¥è¯¢æ–¹æ³•çš„è¯­æ³•ã€‚

<Npm>
drizzle-orm
-D drizzle-kit
</Npm>

```typescript copy
import { drizzle } from 'drizzle-orm/bun-sqlite';
import { Database } from 'bun:sqlite';

const sqlite = new Database('sqlite.db');
const db = drizzle(sqlite);

const result = await db.select().from(users);
```

é™¤éæ‚¨æ‰“ç®—æ‰‹åŠ¨ç¼–å†™æ¯ä¸ª SQL æŸ¥è¯¢ï¼Œå¦åˆ™è¡¨å£°æ˜éå¸¸æœ‰ç”¨ï¼š
```typescript copy
import { sql } from "drizzle-orm";
import { text, integer, sqliteTable } from "drizzle-orm/sqlite-core";

const users = sqliteTable('users', {
  id: text('id'),
  textModifiers: text('text_modifiers').notNull().default(sql`CURRENT_TIMESTAMP`),
  intModifiers: integer('int_modifiers', { mode: 'boolean' }).notNull().default(false),
});
```
æœ‰å…³åˆ—ç±»å‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [Drizzle ä¸­çš„ SQLite åˆ—ç±»å‹](/docs/column-types/sqlite)ã€‚

å¦‚æœè¦ä½¿ç”¨ **sync** APIï¼š
```typescript copy
import { drizzle } from 'drizzle-orm/bun-sqlite';
import { Database } from 'bun:sqlite';

const sqlite = new Database('sqlite.db');
const db = drizzle(sqlite);

const result = db.select().from(users).all();
const result = db.select().from(users).get();
const result = db.select().from(users).values();
const result = db.select().from(users).run();
```
æœ‰å…³ sqlite çš„ **sync** å’Œ **async** API çš„æ›´å¤šä¿¡æ¯ - è¯·é˜…è¯»æ­¤å¤„ã€‚

## Expo SQLite
æ ¹æ®å…¶ [å®˜æ–¹ç½‘ç«™](https://expo.dev/) æè¿°ï¼ŒExpo æ˜¯åŸºäº React Native å¼€å‘ã€æ„å»ºå’Œå‘å¸ƒåº”ç”¨ç¨‹åºçš„å·¥å…·ç”Ÿæ€ç³»ç»Ÿã€‚
å®ƒç”± Hermes JavaScript è¿è¡Œæ—¶å’Œ Metro bundler æä¾›åŠ¨åŠ›ï¼ŒDrizzle Expo é©±åŠ¨ç¨‹åºæ—¨åœ¨åŸç”Ÿæ”¯æŒè¿™ä¸¤è€…ã€‚
  
Drizzle ORM åœ¨ Expo SQLite ä¸­æ‹¥æœ‰æœ€ä½³çš„å·¥å…·åŒ…ï¼š
- Expo SQLite çš„åŸç”Ÿ ORM é©±åŠ¨ç¨‹åº âœ…
- [Drizzle Kit](/kit-docs/overview) æ”¯æŒåº”ç”¨ç¨‹åºä¸­çš„è¿ç§»ç”Ÿæˆå’Œæ†ç»‘ âœ…
- [Drizzle Studio](https://github.com/drizzle-team/drizzle-studio-expo) å¼€å‘å·¥å…·æ’ä»¶ï¼Œç”¨äºæµè§ˆè®¾å¤‡æ•°æ®åº“ âœ…
- å®æ—¶æŸ¥è¯¢ âœ…

<Npm>
drizzle-orm expo-sqlite@next
-D drizzle-kit 
</Npm>

```ts
import { drizzle } from "drizzle-orm/expo-sqlite";
import { openDatabaseSync } from "expo-sqlite/next";

const expo = openDatabaseSync("db.db");
const db = drizzle(expo);

await db.select().from(users);
```
#### å®æ—¶æŸ¥è¯¢
ä½¿ç”¨ `useLiveQuery` é’©å­ï¼Œæ‚¨å¯ä»¥ä½¿ä»»ä½• Drizzle æŸ¥è¯¢å…·æœ‰å“åº”æ€§ï¼š
```ts
import { useLiveQuery, drizzle } from 'drizzle-orm/expo-sqlite';
import { openDatabaseSync } from 'expo-sqlite/next';
import { Text } from 'react-native';
import * as schema from './schema';

const expo = openDatabaseSync('db.db', { enableChangeListener: true }); // <-- enable change listeners
const db = drizzle(expo);

const App = () => {
  // æ•°æ®æ›´æ”¹æ—¶ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“
  const { data } = useLiveQuery(db.select().from(schema.users));
  return <Text>{JSON.stringify(data)}</Text>;
};

export default App;
```

#### ä½¿ç”¨ Drizzle Kit è¿›è¡Œ Expo SQLite è¿ç§»
æ‚¨å¯ä»¥ä½¿ç”¨ Drizzle Kit ç”Ÿæˆ SQL è¿ç§»ã€‚åœ¨è¿›è¡Œä¸‹ä¸€æ­¥ä¹‹å‰ï¼Œè¯·ç¡®ä¿æŸ¥çœ‹ [Drizzle Kit è¿ç§»](/kit-docs/overview) çš„å·¥ä½œåŸç†ã€‚
Expo / React Native è¦æ±‚æ‚¨å°† SQL è¿ç§»æ†ç»‘åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å·²ä¸ºæ‚¨æä¾›è¦†ç›–ã€‚

<Steps>

#### å®‰è£… babel æ’ä»¶
å¿…é¡»ç›´æ¥å°† SQL è¿ç§»æ–‡ä»¶ä½œä¸ºå­—ç¬¦ä¸²æ†ç»‘åˆ°æ‚¨çš„åŒ…ä¸­ã€‚
```shell
npm install babel-plugin-inline-import
```

#### æ›´æ–°é…ç½®æ–‡ä»¶
æ‚¨éœ€è¦æ›´æ–° `babel.config.js`ï¼Œ`metro.config.js` å’Œ `drizzle.config.ts` æ–‡ä»¶
```js filename='babel.config.js'
module.exports = function(api) {
  api.cache(true);

  return {
    presets: ['babel-preset-expo'],
    plugins: [["inline-import", { "extensions": [".sql"] }]] // <-- add this
  };
};
```

```js filename="metro.config.js"
const { getDefaultConfig } = require('expo/metro-config');

/** @type {import('expo/metro-config').MetroConfig} */
const config = getDefaultConfig(__dirname);

config.resolver.sourceExts.push('sql'); // <--- add this

module.exports = config;
```

ç¡®ä¿åœ¨ Drizzle Kit é…ç½®ä¸­æ‹¥æœ‰ `dialect: 'sqlite'` å’Œ `driver: 'expo'`
```ts filename="drizzle.config.ts"
import type { Config } from 'drizzle-kit';

export default {
	schema: './db/schema.ts',
	out: './drizzle',
  dialect: 'sqlite',
	driver: 'expo', // <--- very important
} satisfies Config;
```

#### ç”Ÿæˆè¿ç§»
åœ¨åˆ›å»º SQL æ¨¡å¼æ–‡ä»¶å’Œ drizzle.config.ts æ–‡ä»¶ä¹‹åï¼Œæ‚¨å¯ä»¥ç”Ÿæˆè¿ç§»
```bash
npx drizzle-kit generate
```

#### æ·»åŠ è¿ç§»åˆ°æ‚¨çš„åº”ç”¨ç¨‹åº
ç°åœ¨éœ€è¦ä» `./drizzle` æ–‡ä»¶å¤¹å¯¼å…¥ `migrations.js` æ–‡ä»¶åˆ° Expo/React Native åº”ç”¨ç¨‹åºä¸­ã€‚
æ‚¨å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰ `useMigrations` è¿ç§»é’©å­è¿è¡Œè¿ç§»ï¼Œä¹Ÿå¯ä»¥åœ¨ `useEffect` é’©å­ä¸­æ‰‹åŠ¨è¿è¡Œã€‚

```ts filename="App.tsx"
import { drizzle } from "drizzle-orm/expo-sqlite";
import { openDatabaseSync } from "expo-sqlite/next";
import { useMigrations } from 'drizzle-orm/expo-sqlite/migrator';
import migrations from './drizzle/migrations';

const expoDb = openDatabaseSync("db.db");

const db = drizzle(expoDb);

export default function App() {
  const { success, error } = useMigrations(db, migrations);

  if (error) {
    return (
      <View>
        <Text>Migration error: {error.message}</Text>
      </View>
    );
  }

  if (!success) {
    return (
      <View>
        <Text>Migration is in progress...</Text>
      </View>
    );
  }

  return ...your application component;
}
```
</Steps>

## OP SQLite
æ ¹æ®å…¶ [å®˜æ–¹ç½‘ç«™](https://github.com/OP-Engineering/op-sqlite) æè¿°ï¼ŒOP-SQLite åµŒå…¥äº†æœ€æ–°ç‰ˆæœ¬çš„ SQLiteï¼Œå¹¶æä¾›äº†ä¸€ä¸ªæ‰§è¡Œ SQL æŸ¥è¯¢çš„ä½çº§ APIã€‚

<Npm>
drizzle-orm @op-engineering/op-sqlite
-D drizzle-kit 
</Npm>

```ts
import { drizzle } from "drizzle-orm/op-sqlite";
import { open } from '@op-engineering/op-sqlite';

const opsqlite = open({
  name: 'myDB',
});
const db = drizzle(opsqlite);

await db.select().from(users);
```

æ‚¨å¯ä»¥ä½¿ç”¨ Drizzle Kit ç”Ÿæˆ SQL è¿ç§»ã€‚åœ¨è¿›è¡Œä¸‹ä¸€æ­¥ä¹‹å‰ï¼Œè¯·ç¡®ä¿æŸ¥çœ‹ [Drizzle Kit è¿ç§»](/kit-docs/overview) çš„å·¥ä½œåŸç†ã€‚
OP SQLite è¦æ±‚æ‚¨å°† SQL è¿ç§»æ†ç»‘åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å·²ä¸ºæ‚¨æä¾›è¦†ç›–ã€‚

<Steps>

#### å®‰è£… babel æ’ä»¶
å¿…é¡»ç›´æ¥å°† SQL è¿ç§»æ–‡ä»¶ä½œä¸ºå­—ç¬¦ä¸²æ†ç»‘åˆ°æ‚¨çš„åŒ…ä¸­ã€‚
```shell
npm install babel-plugin-inline-import
```

#### æ›´æ–°é…ç½®æ–‡ä»¶
æ‚¨éœ€è¦æ›´æ–° `babel.config.js`ï¼Œ`metro.config.js` å’Œ `drizzle.config.ts` æ–‡ä»¶
```js filename='babel.config.js'
module.exports = {
  presets: ['module:@react-native/babel-preset'],
  plugins: [
    [
      'inline-import',
      {
        extensions: ['.sql'],
      },
    ],
  ],
};
```

```js filename="metro.config.js"
const { getDefaultConfig } = require('@react-native/metro-config');

const config = getDefaultConfig(__dirname);

config.resolver.sourceExts.push('sql');

module.exports = config;
```

ç¡®ä¿åœ¨ Drizzle Kit é…ç½®ä¸­æ‹¥æœ‰ `dialect: 'sqlite'` å’Œ `driver: 'expo'`
```ts filename="drizzle.config.ts"
import type { Config } from 'drizzle-kit';

export default {
	schema: './db/schema.ts',
	out: './drizzle',
  dialect: 'sqlite',
	driver: 'expo', // <--- very important
} satisfies Config;
```

#### ç”Ÿæˆè¿ç§»
åœ¨åˆ›å»º SQL æ¨¡å¼æ–‡ä»¶å’Œ drizzle.config.ts æ–‡ä»¶ä¹‹åï¼Œæ‚¨å¯ä»¥ç”Ÿæˆè¿ç§»
```bash
npx drizzle-kit generate
```

#### æ·»åŠ è¿ç§»åˆ°æ‚¨çš„åº”ç”¨ç¨‹åº
ç°åœ¨éœ€è¦ä» `./drizzle` æ–‡ä»¶å¤¹å¯¼å…¥ `migrations.js` æ–‡ä»¶åˆ° Expo/React Native åº”ç”¨ç¨‹åºä¸­ã€‚
æ‚¨å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ä½¿ç”¨æˆ‘ä»¬çš„è‡ªå®šä¹‰ `useMigrations` è¿ç§»é’©å­è¿è¡Œè¿ç§»ï¼Œä¹Ÿå¯ä»¥åœ¨ `useEffect` é’©å­ä¸­æ‰‹åŠ¨è¿è¡Œã€‚

```ts filename="App.tsx"
import { drizzle } from "drizzle-orm/op-sqlite";
import { open } from '@op-engineering/op-sqlite';
import { useMigrations } from 'drizzle-orm/op-sqlite/migrator';
import migrations from './drizzle/migrations';

const opsqliteDb = open({
  name: 'myDB',
});

const db = drizzle(opsqliteDb);

export default function App() {
  const { success, error } = useMigrations(db, migrations);

  if (error) {
    return (
      <View>
        <Text>Migration error: {error.message}</Text>
      </View>
    );
  }

  if (!success) {
    return (
      <View>
        <Text>Migration is in progress...</Text>
      </View>
    );
  }

  return ...your application component;
}
```

</Steps>


## React Native SQLite
è¯·ä½¿ç”¨ [`Expo SQLite`](#expo-sqlite) åœ¨ React Native åº”ç”¨ç¨‹åºä¸­è¿è¡Œ Drizzle ORMã€‚
æˆ‘ä»¬å‘ç°å”¯ä¸€çš„ [æµè¡Œåº“](https://github.com/andpor/react-native-sqlite-storage) ä¸æ”¯æŒæ–°çš„ Hermes JavaScript è¿è¡Œæ—¶ï¼Œ
è€Œæ–°çš„ Hermes JavaScript è¿è¡Œæ—¶ç°åœ¨æ˜¯ React Native å’Œ Expo çš„å¼€ç®±å³ç”¨æ ‡å‡†è¿è¡Œæ—¶ã€‚

## better-sqlite3

æ ¹æ®å…¶ [å®˜æ–¹ç½‘ç«™](https://github.com/WiseLibs/better-sqlite3) æè¿°ï¼ŒBetterSqlite3 æ˜¯ Node.js ä¸­æœ€å¿«ã€æœ€ç®€å•çš„ SQLite3 åº“ã€‚

Drizzle ORM é‡‡ç”¨ SQL æ–¹è¨€å’Œæ–¹è¨€ç‰¹å®šçš„é©±åŠ¨ç¨‹åºå’Œè¯­æ³•ï¼Œå¹¶ä¸”ä¸ä»»ä½•å…¶ä»– ORM ä¸åŒï¼Œ
å¯¹äºåƒæ˜¯ `better-sqlite3` è¿™æ ·çš„åŒæ­¥é©±åŠ¨ç¨‹åºï¼Œæˆ‘ä»¬åŒæ—¶å…·æœ‰ **async** å’Œ **sync** APIï¼Œå¹¶ä¸”æˆ‘ä»¬æ¨¡æ‹Ÿäº†æœ€æµè¡Œçš„ç±»ä¼¼ SQLite çš„ `all`ã€`get`ã€`values` å’Œ `run` æŸ¥è¯¢æ–¹æ³•çš„è¯­æ³•ã€‚

<Npm>
drizzle-orm better-sqlite3
-D drizzle-kit 
</Npm>


```typescript copy
import { drizzle } from 'drizzle-orm/better-sqlite3';
import Database from 'better-sqlite3';

const sqlite = new Database('sqlite.db');
const db = drizzle(sqlite);

const result = await db.select().from(users);
```

é™¤éæ‚¨æ‰“ç®—æ‰‹åŠ¨ç¼–å†™æ¯ä¸ª SQL æŸ¥è¯¢ï¼Œå¦åˆ™è¡¨å£°æ˜éå¸¸æœ‰ç”¨ï¼š
```typescript copy
import { sql } from "drizzle-orm";
import { text, integer, sqliteTable } from "drizzle-orm/sqlite-core";

const users = sqliteTable('users', {
  id: text('id'),
  textModifiers: text('text_modifiers').notNull().default(sql`CURRENT_TIMESTAMP`),
  intModifiers: integer('int_modifiers', { mode: 'boolean' }).notNull().default(false),
});
```
æœ‰å…³åˆ—ç±»å‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [Drizzle ä¸­çš„ SQLite åˆ—ç±»å‹](/docs/column-types/sqlite)ã€‚

<Callout type="info" emoji="â„¹ï¸">
  å¦‚æœæ‚¨çš„ `db.insert()` è¿”å›æ•°æ®ï¼Œè¯·åœ¨æŸ¥è¯¢ä¸­æ·»åŠ  `all()`ï¼Œå¦åˆ™æ·»åŠ  `run()`
</Callout>

å¦‚æœè¦ä½¿ç”¨ **sync** APIï¼š
```typescript copy
import { drizzle, BetterSQLite3Database } from 'drizzle-orm/better-sqlite3';
import Database from 'better-sqlite3';

const sqlite = new Database('sqlite.db');
const db: BetterSQLite3Database = drizzle(sqlite);

const result = db.select().from(users).all();
const result = db.select().from(users).get();
const result = db.select().from(users).values();
const result = db.select().from(users).run();
```
æœ‰å…³ sqlite çš„ **sync** å’Œ **async** API çš„æ›´å¤šä¿¡æ¯ - è¯·é˜…è¯»æ­¤å¤„ã€‚

## HTTP ä»£ç†

Drizzle ORM è¿˜æ”¯æŒä½¿ç”¨å¼‚æ­¥å›è°ƒå‡½æ•°è¿›è¡Œæ‰§è¡Œ SQLã€‚

- `sql` æ˜¯å¸¦æœ‰å ä½ç¬¦çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚
- `params` æ˜¯å‚æ•°çš„æ•°ç»„ã€‚
- æ ¹æ® SQL è¯­å¥ï¼Œ`method` çš„å€¼å°†è®¾ä¸º `run`ã€`all`ã€`values` æˆ– `get`ã€‚
Drizzle å§‹ç»ˆç­‰å¾…è¿”å›å€¼ä¸º `{rows: string[][]}` æˆ– `{rows: string[]}`ã€‚

- å½“ `method` ä¸º `get` æ—¶ï¼Œæ‚¨åº”è¯¥è¿”å›ä¸€ä¸ªå€¼ä¸º `{rows: string[]}` çš„å¯¹è±¡ã€‚
- å¦åˆ™ï¼Œæ‚¨åº”è¿”å› `{rows: string[][]}` çš„å¯¹è±¡ã€‚

```typescript copy
import { drizzle } from 'drizzle-orm/sqlite-proxy';

const db = drizzle(async (sql, params, method) => {
  try {
    const rows = await axios.post('http://localhost:3000/query', { sql, params, method });

    return { rows: rows.data };
  } catch (e: any) {
    console.error('Error from sqlite proxy server: ', e.response.data)
    return { rows: [] };
  }
});
```

**æ‰¹é‡æ”¯æŒ**

Sqlite ä»£ç†æ”¯æŒæ‰¹é‡è¯·æ±‚ï¼Œä¸æ‰€æœ‰å…¶ä»–é©±åŠ¨ç¨‹åºä¸€æ ·ã€‚æŸ¥çœ‹å®Œæ•´çš„ [æ–‡æ¡£](/docs/batch-api)ã€‚

æ‚¨éœ€è¦ä¸ºæ‰¹é‡æŸ¥è¯¢æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„å›è°ƒå‡½æ•°ï¼Œå¹¶å¤„ç†å¯¹ä»£ç†æœåŠ¡å™¨çš„è¯·æ±‚ï¼š

```ts
import { drizzle } from 'drizzle-orm/sqlite-proxy';

type ResponseType = { rows: any[][] | any[] }[];

const db = drizzle(async (sql, params, method) => {
  // single queries logic. Same as in code above
}, async (queries: { sql: string, params: any[], method: 'all' | 'run' | 'get' | 'values'}[]) => {
		try {
			const result: ResponseType = await axios.post('http://localhost:3000/batch', { queries });

			return result;
		} catch (e: any) {
			console.error('Error from sqlite proxy server:', e);
			throw e;
		}
	});
```

ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `db.batch([])` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†ä»£ç†æ‰€æœ‰æŸ¥è¯¢ã€‚

<Callout>
  æ‰¹å¤„ç†çš„å“åº”åº”ä¸ºåŸå§‹å€¼æ•°ç»„ï¼ˆæ•°ç»„å†…çš„æ•°ç»„ï¼‰ï¼Œé¡ºåºä¸å‘é€åˆ°ä»£ç†æœåŠ¡å™¨çš„é¡ºåºç›¸åŒã€‚
</Callout>

---

é™¤éæ‚¨æ‰“ç®—æ‰‹åŠ¨ç¼–å†™æ¯ä¸ª SQL æŸ¥è¯¢ï¼Œå¦åˆ™è¡¨å£°æ˜éå¸¸æœ‰ç”¨ï¼š
```typescript copy
import { sql } from "drizzle-orm";
import { text, integer, sqliteTable } from "drizzle-orm/sqlite-core";

const users = sqliteTable('users', {
  id: text('id'),
  textModifiers: text('text_modifiers').notNull().default(sql`CURRENT_TIMESTAMP`),
  intModifiers: integer('int_modifiers', { mode: 'boolean' }).notNull().default(false),
});
```
æœ‰å…³åˆ—ç±»å‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [Drizzle ä¸­çš„ SQLite åˆ—ç±»å‹](/docs/column-types/sqlite)ã€‚
