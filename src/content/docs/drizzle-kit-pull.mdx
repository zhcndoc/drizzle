import CodeTab from "@mdx/CodeTab.astro";
import CodeTabs from "@mdx/CodeTabs.astro";
import Section from "@mdx/Section.astro";
import Tab from "@mdx/Tab.astro";
import Tabs from "@mdx/Tabs.astro";
import Callout from "@mdx/Callout.astro";
import Prerequisites from "@mdx/Prerequisites.astro";
import Drivers from "@mdx/Drivers.mdx"
import Dialects from "@mdx/Dialects.mdx"
import Npm from "@mdx/Npm.astro"
import Npx from "@mdx/Npx.astro"

# `drizzle-kit pull`

<Prerequisites>
  - å¼€å§‹ä½¿ç”¨ Drizzle å’Œ `drizzle-kit` - [é˜…è¯»è¿™é‡Œ](/docs/get-started)
  - Drizzle æ¨¡å¼åŸºç¡€ - [é˜…è¯»è¿™é‡Œ](/docs/sql-schema-declaration) 
  - æ•°æ®åº“è¿æ¥åŸºç¡€ - [é˜…è¯»è¿™é‡Œ](/docs/connect-overview) 
  - Drizzle è¿ç§»åŸºç¡€ - [é˜…è¯»è¿™é‡Œ](/docs/migrations) 
  - Drizzle Kit [æ¦‚è¿°](/docs/kit-overview) ä»¥åŠ [é…ç½®æ–‡ä»¶](/docs/drizzle-config-file) æ–‡æ¡£
</Prerequisites>

`drizzle-kit pull` å…è®¸ä½ ä»ç°æœ‰æ•°æ®åº“æ¨¡å¼ä¸­æå–ï¼ˆè‡ªçœï¼‰æ•°æ®ï¼Œç”Ÿæˆ `schema.ts` drizzle æ¨¡å¼æ–‡ä»¶ï¼Œ
å®ƒè®¾è®¡ç”¨äºæ”¯æŒ Drizzle è¿ç§»çš„ [æ•°æ®åº“ä¼˜å…ˆ](/docs/migrations) æ–¹æ³•ã€‚

<Callout collapsed="å®ƒèƒŒåæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ">
å½“ä½ è¿è¡Œ Drizzle Kit çš„ `pull` å‘½ä»¤æ—¶ï¼Œå®ƒä¼šï¼š
1. ä»ç°æœ‰æ•°æ®åº“ä¸­æå–æ•°æ®åº“æ¨¡å¼ï¼ˆDDLï¼‰
2. ç”Ÿæˆ `schema.ts` drizzle æ¨¡å¼æ–‡ä»¶å¹¶å°†å…¶ä¿å­˜åœ¨ `out` æ–‡ä»¶å¤¹ä¸­

<Section>
```
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 
                                  â”‚                        â”‚ <---  CREATE TABLE "users" (
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                        â”‚        "id" SERIAL PRIMARY KEY,
â”‚ ~ drizzle-kit pull       â”‚      â”‚                        â”‚        "name" TEXT,
â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚        DATABASE        â”‚        "email" TEXT UNIQUE
  â”‚                               â”‚                        â”‚       );
  â”” Pull æ•°æ®åº“æ¨¡å¼ --------> â”‚                        â”‚
  â”Œ ç”Ÿæˆ Drizzle æ‰€éœ€       <----- â”‚                        â”‚
  â”‚ æ¨¡å¼ TypeScript æ–‡ä»¶        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  v
```
```typescript
import * as p from "drizzle-orm/pg-core";

export const users = p.pgTable("users", {
  id: p.serial().primaryKey(),
  name: p.text(),
  email: p.text().unique(), 
};
```
</Section>
</Callout>

è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œé€‚åˆéœ€è¦åœ¨ TypeScript é¡¹ç›®ä¹‹å¤–ç®¡ç†æ•°æ®åº“æ¨¡å¼çš„æƒ…å†µï¼Œæˆ–è€…
æ‚¨æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªç”±å…¶ä»–äººç®¡ç†çš„æ•°æ®åº“ã€‚

<br/>
<hr/>
<br/>

`drizzle-kit pull` è¦æ±‚æ‚¨æŒ‡å®š `dialect` ä»¥åŠ
æ•°æ®åº“è¿æ¥ `url` æˆ– `user:password@host:port/db` å‚æ•°ï¼Œæ‚¨å¯ä»¥é€šè¿‡
[drizzle.config.ts](/docs/drizzle-config-file) é…ç½®æ–‡ä»¶æˆ–é€šè¿‡ CLI é€‰é¡¹æä¾›å®ƒä»¬ï¼š

<CodeTabs items={["ä½¿ç”¨é…ç½®æ–‡ä»¶", "ä½¿ç”¨ CLI é€‰é¡¹"]}>
<Section>
```ts
// drizzle.config.ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "postgresql",
  dbCredentials: {
    url: "postgresql://user:password@host:port/dbname",
  },
});
```
```shell
npx drizzle-kit pull
```
</Section>

```shell
npx drizzle-kit pull --dialect=postgresql --url=postgresql://user:password@host:port/dbname
```
</CodeTabs>

### åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨å¤šä¸ªé…ç½®æ–‡ä»¶

æ‚¨å¯ä»¥åœ¨é¡¹ç›®ä¸­æ‹¥æœ‰å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œå½“æ‚¨æœ‰å¤šä¸ªæ•°æ®åº“é˜¶æ®µã€å¤šä¸ªæ•°æ®åº“æˆ–åŒä¸€é¡¹ç›®ä¸­çš„ä¸åŒæ•°æ®åº“æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ï¼š

<Npx>
  drizzle-kit pull --config=drizzle-dev.config.ts
  drizzle-kit pull --config=drizzle-prod.config.ts
</Npx>
```plaintext {5-6}
ğŸ“¦ <é¡¹ç›®æ ¹ç›®å½•>
 â”œ ğŸ“‚ drizzle
 â”œ ğŸ“‚ src
 â”œ ğŸ“œ .env
 â”œ ğŸ“œ drizzle-dev.config.ts
 â”œ ğŸ“œ drizzle-prod.config.ts
 â”œ ğŸ“œ package.json
 â”” ğŸ“œ tsconfig.json
```

### æŒ‡å®šæ•°æ®åº“é©±åŠ¨
<Callout type="warning">
**Expo SQLite** å’Œ **OP SQLite** æ˜¯è®¾å¤‡å†…ï¼ˆæ¯ç”¨æˆ·ï¼‰æ•°æ®åº“ï¼Œæ— æ³•ä»ä¸­ `pull` æ•°æ®åº“æ¨¡å¼ã€‚<br/>
å¯¹äºåµŒå…¥å¼æ•°æ®åº“ï¼ŒDrizzle æä¾› **åµŒå…¥å¼è¿ç§»** - è¯·æŸ¥çœ‹æˆ‘ä»¬çš„ [å¼€å§‹ä½¿ç”¨](/docs/get-started/expo-new) æŒ‡å—ã€‚
</Callout>
Drizzle Kit ä¸è‡ªå¸¦é¢„æ‰“åŒ…çš„æ•°æ®åº“é©±åŠ¨ï¼Œ
å®ƒä¼šæ ¹æ®å½“å‰é¡¹ç›®ä¸­çš„ `dialect` è‡ªåŠ¨é€‰æ‹©å¯ç”¨çš„æ•°æ®åº“é©±åŠ¨ - [æŸ¥çœ‹è®¨è®º](https://github.com/drizzle-team/drizzle-orm/discussions/2203)ã€‚

å¤§å¤šæ•°ç›¸åŒæ–¹è¨€çš„é©±åŠ¨å…±äº«ç›¸åŒçš„è¿æ¥å‚æ•°é›†ï¼Œ
å¯¹äºåƒ `aws-data-api`ã€`pglight` å’Œ `d1-http` è¿™æ ·çš„ä¾‹å¤–æƒ…å†µ - æ‚¨éœ€è¦æ˜ç¡®æŒ‡å®š `driver` å‚æ•°ã€‚

<CodeTabs items={["AWS Data API", "PGLite", "Cloudflare D1 HTTP"]}>
```ts {6}
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "postgresql",
  driver: "aws-data-api",
  dbCredentials: {
    database: "database",
    resourceArn: "resourceArn",
    secretArn: "secretArn",
  },
};
```
```ts {6}
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "postgresql",
  driver: "pglite",
  dbCredentials: {
    // å†…å­˜ä¸­
    url: ":memory:"
    
    // æˆ–æ•°æ®åº“æ–‡ä»¶å¤¹
    url: "./database/"
  },
};
```
```ts {6}
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "sqlite",
  driver: "d1-http",
  dbCredentials: {
    accountId: "accountId",
    databaseId: "databaseId",
    token: "token",
  },
};
```
</CodeTabs>

### åŒ…å«è¡¨ã€æ¨¡å¼å’Œæ‰©å±•
`drizzle-kit push` é»˜è®¤ä¼šç®¡ç† `public` æ¨¡å¼ä¸­çš„æ‰€æœ‰è¡¨ã€‚
æ‚¨å¯ä»¥é€šè¿‡ `tablesFilters`ã€`schemaFilter` å’Œ `extensionFilters` é€‰é¡¹é…ç½®è¡¨ã€æ¨¡å¼å’Œæ‰©å±•çš„åˆ—è¡¨ã€‚

|                     |                                                                                               |
| :------------------ | :-------------------------------------------------------------------------------------------- |
| `tablesFilter`      | åŸºäº `glob` çš„è¡¨åè¿‡æ»¤å™¨ï¼Œä¾‹å¦‚ `["users", "user_info"]` æˆ– `"user*"`ã€‚é»˜è®¤ä¸º `"*"` |
| `schemaFilter`      | æ¨¡å¼åè¿‡æ»¤å™¨ï¼Œä¾‹å¦‚ `["public", "drizzle"]`ã€‚é»˜è®¤ä¸º `["public"]`                    |
| `extensionsFilters` | å·²å®‰è£…çš„æ•°æ®åº“æ‰©å±•åˆ—è¡¨ï¼Œä¾‹å¦‚ `["postgis"]`ã€‚é»˜è®¤ä¸º `[]`                    |
<br/>

è®©æˆ‘ä»¬é…ç½® drizzle-kit åªæ“ä½œ **public** æ¨¡å¼ä¸­çš„ **æ‰€æœ‰è¡¨**ï¼Œ
å¹¶å‘ŠçŸ¥ drizzle-kit å·²å®‰è£…äº† **postgis** æ‰©å±•ï¼Œ 
ä»¥ä½¿å…¶å¯ä»¥å¿½ç•¥åœ¨å…¬å…±æ¨¡å¼ä¸­åˆ›å»ºè‡ªå·±çš„è¡¨ã€‚

<Section>
```ts filename="drizzle.config.ts" {9-11}
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "postgresql",
  schema: "./src/schema.ts",
  dbCredentials: {
    url: "postgresql://user:password@host:port/dbname",
  },
  extensionsFilters: ["postgis"],
  schemaFilter: ["public"],
  tablesFilter: ["*"],
});
```
```shell
npx drizzle-kit push
```
</Section>

### æ‰©å±•çš„é…ç½®åˆ—è¡¨
æˆ‘ä»¬å»ºè®®é€šè¿‡ [drizzle.config.ts](/docs/drizzle-config-file) æ–‡ä»¶æ¥é…ç½® `drizzle-kit`ï¼Œ 
ä¸è¿‡å¦‚æœå¿…è¦çš„è¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ CLI æä¾›æ‰€æœ‰é…ç½®é€‰é¡¹ï¼Œä¾‹å¦‚åœ¨ CI/CD ç®¡é“ä¸­ç­‰ã€‚

|                     |            |                                                                           |
| :------------------ | :--------- | :------------------------------------------------------------------------ |
| `dialect`           | `å¿…éœ€`     | æ•°æ®åº“æ–¹è¨€, é€‰é¡¹ä¹‹ä¸€ <Dialects/>                                      |
| `driver`            |            | é©±åŠ¨ç¨‹åºä¾‹å¤– <Drivers/>                                             |
| `out`               |            | è¿ç§»è¾“å‡ºæ–‡ä»¶å¤¹è·¯å¾„ï¼Œé»˜è®¤æ˜¯ `./drizzle`                     |
| `url`               |            | æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²                                                |
| `user`              |            | æ•°æ®åº“ç”¨æˆ·                                                             |
| `password`          |            | æ•°æ®åº“å¯†ç                                                          |
| `host`              |            | ä¸»æœº                                                                      |
| `port`              |            | ç«¯å£                                                                      |
| `database`          |            | æ•°æ®åº“åç§°                                                             |
| `config`            |            | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤æ˜¯ `drizzle.config.ts`                          |
| `introspect-casing` |            | åˆ—ã€è¡¨ç­‰ä¸­ JS é”®åˆ›å»ºçš„ç­–ç•¥ï¼Œ`preserve` `camel` |
| `tablesFilter`      |            | è¡¨åè¿‡æ»¤å™¨                                                         |
| `schemaFilter`      |            | æ¨¡å¼åè¿‡æ»¤å™¨ã€‚é»˜è®¤ä¸º `["public"]`                                 |
| `extensionsFilters` |            | æ•°æ®åº“æ‰©å±•çš„å†…éƒ¨æ•°æ®åº“è¿‡æ»¤å™¨                             |

<Npx>
drizzle-kit pull --dialect=postgresql --schema=src/schema.ts --url=postgresql://user:password@host:port/dbname
drizzle-kit pull --dialect=postgresql --schema=src/schema.ts --driver=pglite url=database/
drizzle-kit pull --dialect=postgresql --schema=src/schema.ts --tablesFilter='user*' --extensionsFilters=postgis url=postgresql://user:password@host:port/dbname
</Npx>

![](@/assets/gifs/introspect_mysql.gif)