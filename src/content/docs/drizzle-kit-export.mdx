import CodeTab from "@mdx/CodeTab.astro";
import CodeTabs from "@mdx/CodeTabs.astro";
import Section from "@mdx/Section.astro";
import Tab from "@mdx/Tab.astro";
import Tabs from "@mdx/Tabs.astro";
import Callout from "@mdx/Callout.astro";
import Prerequisites from "@mdx/Prerequisites.astro"
import Npx from "@mdx/Npx.astro";
import SchemaFilePaths from "@mdx/SchemaFilePaths.mdx"
import Dialects from "@mdx/Dialects.mdx"

# `drizzle-kit export`

<Prerequisites>
- å¼€å§‹ä½¿ç”¨ Drizzle å’Œ `drizzle-kit` - [é˜…è¯»è¿™é‡Œ](/docs/get-started)
- Drizzle æ¶æ„åŸºç¡€ - [é˜…è¯»è¿™é‡Œ](/docs/sql-schema-declaration)
- æ•°æ®åº“è¿æ¥åŸºç¡€ - [é˜…è¯»è¿™é‡Œ](/docs/connect-overview)
- Drizzle è¿ç§»åŸºç¡€ - [é˜…è¯»è¿™é‡Œ](/docs/migrations)
- Drizzle Kit [æ¦‚è¿°](/docs/kit-overview) å’Œ [é…ç½®æ–‡ä»¶](/docs/drizzle-config-file)
</Prerequisites>

<br/>

`drizzle-kit export` è®©ä½ å¯¼å‡º Drizzle æ¶æ„çš„ SQL è¡¨ç¤ºï¼Œå¹¶åœ¨æ§åˆ¶å°æ‰“å°å…¶ SQL DDL è¡¨ç¤ºã€‚
<Callout collapsed="å®ƒæ˜¯å¦‚ä½•åœ¨åå°å·¥ä½œçš„ï¼Ÿ">
Drizzle Kit `export` å‘½ä»¤è§¦å‘ä¸€ç³»åˆ—äº‹ä»¶ï¼š
1. å®ƒå°†è¯»å–ä½ çš„ Drizzle æ¶æ„æ–‡ä»¶å¹¶ç”Ÿæˆæ¶æ„çš„ JSON å¿«ç…§
3. åŸºäº JSON å·®å¼‚ï¼Œå®ƒå°†ç”Ÿæˆ SQL DDL è¯­å¥
4. è¾“å‡º SQL DDL è¯­å¥åˆ°æ§åˆ¶å°
</Callout>

å®ƒæ—¨åœ¨è¦†ç›– [ä»£ç ä¼˜å…ˆ](/docs/migrations) çš„ Drizzle è¿ç§»ç®¡ç†æ–¹æ³•ã€‚  
ä½ å¯ä»¥å¯¼å‡º Drizzle æ¶æ„çš„ SQL è¡¨ç¤ºï¼Œå…è®¸åƒ Atlas è¿™æ ·çš„å¤–éƒ¨å·¥å…·ä¸ºä½ å¤„ç†æ‰€æœ‰è¿ç§»ã€‚

`drizzle-kit export` å‘½ä»¤è¦æ±‚ä½ æä¾› `dialect` å’Œ `schema` è·¯å¾„é€‰é¡¹ï¼Œ  
ä½ å¯ä»¥é€šè¿‡ [drizzle.config.ts](/docs/drizzle-config-file) é…ç½®æ–‡ä»¶æˆ–é€šè¿‡ CLI é€‰é¡¹è®¾ç½®å®ƒä»¬ã€‚
<CodeTabs items={["ä½¿ç”¨é…ç½®æ–‡ä»¶", "ä½œä¸º CLI é€‰é¡¹"]}>
<Section>
```ts
// drizzle.config.ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "postgresql",
  schema: "./src/schema.ts",
});
```
```shell
npx drizzle-kit export
```
</Section>

```shell
npx drizzle-kit export --dialect=postgresql --schema=./src/schema.ts
```
</CodeTabs>

### æ¶æ„æ–‡ä»¶è·¯å¾„
ä½ å¯ä»¥æ‹¥æœ‰ä¸€ä¸ª `schema.ts` æ–‡ä»¶ï¼Œæˆ–è€…æ ¹æ®éœ€è¦åœ¨é¡¹ç›®ä¸­åˆ†å¸ƒå¤šä¸ªæ¶æ„æ–‡ä»¶ã€‚  
Drizzle Kit è¦æ±‚ä½ é€šè¿‡ `schema` é…ç½®é€‰é¡¹æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ [glob](https://www.digitalocean.com/community/tools/glob?comments=true&glob=/**/*.js&matches=false&tests=//%20This%20will%20match%20as%20it%20ends%20with%20'.js'&tests=/hello/world.js&tests=//%20This%20won't%20match!&tests=/test/some/globs) æ¥æŒ‡å®šè·¯å¾„ã€‚

<SchemaFilePaths/>

### ä¸€ä¸ªé¡¹ç›®ä¸­çš„å¤šä¸ªé…ç½®æ–‡ä»¶
ä½ å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿™åœ¨æœ‰å¤šä¸ªæ•°æ®åº“é˜¶æ®µæˆ–å¤šä¸ªæ•°æ®åº“ï¼Œæˆ–åŒä¸€é¡¹ç›®ä¸­ä½¿ç”¨ä¸åŒæ•°æ®åº“æ—¶éå¸¸æœ‰ç”¨ï¼š
<Npx>
  drizzle-kit export --config=drizzle-dev.config.ts
  drizzle-kit export --config=drizzle-prod.config.ts
</Npx>
```plaintext {5-6}
ğŸ“¦ <é¡¹ç›®æ ¹ç›®å½•>
 â”œ ğŸ“‚ drizzle
 â”œ ğŸ“‚ src
 â”œ ğŸ“œ .env
 â”œ ğŸ“œ drizzle-dev.config.ts
 â”œ ğŸ“œ drizzle-prod.config.ts
 â”œ ğŸ“œ package.json
 â”” ğŸ“œ tsconfig.json
```

### å¯ç”¨é…ç½®é¡¹çš„æ‰©å±•åˆ—è¡¨
`drizzle-kit export` æœ‰ä¸€ä¸ªä»…é™ CLI çš„é€‰é¡¹åˆ—è¡¨

<rem025/>

|               |                                                      |
| :--------     | :--------------------------------------------------- |
| `--sql`       | ç”Ÿæˆ Drizzle æ¶æ„çš„ SQL è¡¨ç¤º                              |

é»˜è®¤æƒ…å†µä¸‹ï¼ŒDrizzle Kit è¾“å‡º SQL æ–‡ä»¶ï¼Œä½†æœªæ¥æˆ‘ä»¬å¸Œæœ›æ”¯æŒä¸åŒçš„æ ¼å¼

<rem025/>

<Npx>
drizzle-kit push --name=init
drizzle-kit push --name=seed_users --custom
</Npx>

<br/>
<hr/>
<br/>
æˆ‘ä»¬æ¨èé€šè¿‡ [drizzle.config.ts](/docs/drizzle-config-file) æ–‡ä»¶é…ç½® `drizzle-kit`ï¼Œ  
ä½†å¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ CLI æä¾›æ‰€æœ‰é…ç½®é€‰é¡¹ï¼Œä¾‹å¦‚åœ¨ CI/CD ç®¡é“ä¸­ç­‰ã€‚

|               |            |                                                                            |
| :------------ | :-------   | :----------------------------------------------------------------------    |
| `dialect`     | `å¿…éœ€`     | æ•°æ®åº“æ–¹è¨€ï¼Œå¯é€‰å€¼è§ <Dialects/>                                       |
| `schema`      | `å¿…éœ€`     | TypeScript æ¶æ„æ–‡ä»¶æˆ–åŒ…å«å¤šä¸ªæ¶æ„æ–‡ä»¶çš„æ–‡ä»¶å¤¹è·¯å¾„                        |
| `config`      |            | é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤æ˜¯ `drizzle.config.ts`                                |

### ç¤ºä¾‹
å¦‚ä½•å°† Drizzle æ¶æ„å¯¼å‡ºåˆ°æ§åˆ¶å°ï¼ŒDrizzle æ¶æ„ä½äº `./src/schema.ts`

æˆ‘ä»¬è¿˜å°†æŠŠ Drizzle é…ç½®æ–‡ä»¶æ”¾åœ¨ `configs` æ–‡ä»¶å¤¹ä¸­ã€‚

è®©æˆ‘ä»¬åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š

```plaintext {4}
ğŸ“¦ <é¡¹ç›®æ ¹ç›®å½•>
 â”œ ğŸ“‚ configs
 â”‚ â”” ğŸ“œ drizzle.config.ts
 â”œ ğŸ“‚ src
 â”‚ â”” ğŸ“œ schema.ts
 â”” â€¦
```
```ts filename='drizzle.config.ts'
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: "postgresql",
  schema: "./src/schema.ts",
});
```

```ts filename='schema.ts'
import { pgTable, serial, text } from 'drizzle-orm/pg-core'

export const users = pgTable('users', {
	id: serial('id').primaryKey(),
	email: text('email').notNull(),
	name: text('name')
});
```

ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œï¼š
```shell
npx drizzle-kit export --config=./configs/drizzle.config.ts
```
å®ƒå°†æˆåŠŸè¾“å‡º Drizzle æ¶æ„çš„ SQL è¡¨ç¤ºï¼š
```bash
CREATE TABLE "users" (
        "id" serial PRIMARY KEY NOT NULL,
        "email" text NOT NULL,
        "name" text
);
```