import Tab from '@mdx/Tab.astro';
import Tabs from '@mdx/Tabs.astro';
import Callout from '@mdx/Callout.astro';
import SimpleLinkCards from '@mdx/SimpleLinkCards.astro';
import CodeTabs from "@mdx/CodeTabs.astro";
import Section from '@mdx/Section.astro';
import Flex from "@mdx/Flex.astro"
import LinksList from "@mdx/LinksList.astro"

# Drizzle æ¨¡å¼

Drizzle å…è®¸æ‚¨ä½¿ç”¨ TypeScript å®šä¹‰æ¨¡å¼ï¼Œæ”¯æŒåº•å±‚æ•°æ®åº“çš„å„ç§æ¨¡å‹å’Œå±æ€§ã€‚  
å½“æ‚¨å®šä¹‰æ¨¡å¼æ—¶ï¼Œå®ƒå°†ä½œä¸ºæœªæ¥æŸ¥è¯¢ï¼ˆä½¿ç”¨ Drizzle-ORMï¼‰å’Œè¿ç§»ï¼ˆä½¿ç”¨ Drizzle-Kitï¼‰  
ä¿®æ”¹çš„çœŸå®æ€§æºã€‚

<Callout> 
å¦‚æœæ‚¨ä½¿ç”¨ Drizzle-Kit è¿›è¡Œè¿ç§»è¿‡ç¨‹ï¼Œè¯·ç¡®ä¿ä»æ‚¨æ¨¡å¼æ–‡ä»¶ä¸­å¯¼å‡ºæ‰€æœ‰å®šä¹‰çš„æ¨¡å‹ï¼Œä»¥ä¾¿ Drizzle-Kit å¯ä»¥å¯¼å…¥å®ƒä»¬å¹¶åœ¨è¿ç§»å·®å¼‚è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚
</Callout>

<CodeTabs items={["ä½¿ç”¨å¯¼å…¥", "ä½¿ç”¨å›è°ƒ", "ä½¿ç”¨ import *"]}>
```ts
import { integer, pgTable, varchar } from "drizzle-orm/pg-core";

export const usersTable = pgTable("users", {
  id: integer().primaryKey().generatedAlwaysAsIdentity(),
  name: varchar().notNull(),
  age: integer().notNull(),
  email: varchar().notNull().unique(),
});
```
```ts
import { pgTable } from "drizzle-orm/pg-core";

export const usersTable = pgTable("users", (t) => ({
  id: t.integer().primaryKey().generatedAlwaysAsIdentity(),
  name: t.varchar().notNull(),
  age: t.integer().notNull(),
  email: t.varchar().notNull().unique(),
}));
```
```ts
import * as p from "drizzle-orm/pg-core";

export const usersTable = p.pgTable("users", {
  id: p.integer().primaryKey().generatedAlwaysAsIdentity(),
  name: p.varchar().notNull(),
  age: p.integer().notNull(),
  email: p.varchar().notNull().unique(),
});
```
</CodeTabs>

## ç»„ç»‡æ‚¨çš„æ¨¡å¼æ–‡ä»¶  
æ‚¨å¯ä»¥å°† SQL æ¨¡å¼ç›´æ¥åœ¨ TypeScript ä¸­å£°æ˜ï¼Œæˆ–è€…å°†æ‰€æœ‰å†…å®¹æ”¾åœ¨ä¸€ä¸ª `schema.ts` æ–‡ä»¶ä¸­ï¼Œ  
æˆ–è€…æ‚¨å¯ä»¥åˆ†æ•£å®ƒä»¬â€”â€”éšæ‚¨æ‰€æ„¿ï¼Œå®Œå…¨æ²¡æœ‰é™åˆ¶ï¼

#### å•æ–‡ä»¶ä¸­çš„æ¨¡å¼  
ä½¿ç”¨ Drizzle å£°æ˜æ¨¡å¼çš„æœ€å¸¸è§æ–¹æ³•æ˜¯å°†æ‰€æœ‰è¡¨æ”¾åœ¨ä¸€ä¸ª `schema.ts` æ–‡ä»¶ä¸­ã€‚

> æ³¨æ„ï¼šæ‚¨å¯ä»¥å°†æ¨¡å¼æ–‡ä»¶å‘½åä¸ºæ‚¨å–œæ¬¢çš„ä»»ä½•åç§°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æ˜¯ `models.ts` æˆ–å…¶ä»–åç§°ã€‚

å¦‚æœæ‚¨æ²¡æœ‰å®šä¹‰å¤ªå¤šè¡¨æ¨¡å‹ï¼Œæˆ–è€…æ‚¨è®¤ä¸ºå°†å®ƒä»¬æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æ²¡æœ‰é—®é¢˜ï¼Œè¿™ç§æ–¹æ³•æ•ˆæœå¾ˆå¥½ã€‚

ç¤ºä¾‹ï¼š  
```plaintext
ğŸ“¦ <é¡¹ç›®æ ¹ç›®å½•>
 â”” ğŸ“‚ src
    â”” ğŸ“‚ db
       â”” ğŸ“œ schema.ts
```

åœ¨ `drizzle.config.ts` æ–‡ä»¶ä¸­ï¼Œæ‚¨éœ€è¦æŒ‡å®šæ¨¡å¼æ–‡ä»¶çš„è·¯å¾„ã€‚  
é€šè¿‡æ­¤é…ç½®ï¼ŒDrizzle å°†ä» `schema.ts` æ–‡ä»¶è¯»å–å¹¶åœ¨è¿ç§»ç”Ÿæˆè¿‡ç¨‹ä¸­ä½¿ç”¨æ­¤ä¿¡æ¯ã€‚  
æœ‰å…³ `drizzle.config.ts` æ–‡ä»¶å’Œä½¿ç”¨ Drizzle è¿›è¡Œè¿ç§»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š[é“¾æ¥](/docs/drizzle-config-file)  
```ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: 'postgresql', // 'mysql' | 'sqlite' | 'turso'
  schema: './src/db/schema.ts'
})
```

#### å¤šæ–‡ä»¶ä¸­çš„æ¨¡å¼

æ‚¨å¯ä»¥å°† Drizzle æ¨¡å‹ï¼ˆä¾‹å¦‚è¡¨ã€æšä¸¾ã€åºåˆ—ç­‰ï¼‰æ”¾ç½®åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ä»»ä½•æ‚¨æƒ³è¦çš„æ–‡ä»¶ä¸­ã€‚  
æ‚¨éœ€è¦ç¡®ä¿ä»è¿™äº›æ–‡ä»¶ä¸­å¯¼å‡ºæ‰€æœ‰æ¨¡å‹ï¼Œ  
ä»¥ä¾¿ Drizzle kit å¯ä»¥å¯¼å…¥å¹¶åœ¨è¿ç§»ä¸­ä½¿ç”¨å®ƒä»¬ã€‚

ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹æ˜¯å°†æ¯ä¸ªè¡¨åˆ†å¼€åˆ°è‡ªå·±çš„æ–‡ä»¶ä¸­ã€‚  
```plaintext
ğŸ“¦ <é¡¹ç›®æ ¹ç›®å½•>
 â”” ğŸ“‚ src
    â”” ğŸ“‚ db
       â”” ğŸ“‚ schema
          â”œ ğŸ“œ users.ts
          â”œ ğŸ“œ countries.ts
          â”œ ğŸ“œ cities.ts
          â”œ ğŸ“œ products.ts
          â”œ ğŸ“œ clients.ts
          â”” ğŸ“œ etc.ts
```

åœ¨ `drizzle.config.ts` æ–‡ä»¶ä¸­ï¼Œæ‚¨éœ€è¦æŒ‡å®šæ¨¡å¼æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚  
é€šè¿‡æ­¤é…ç½®ï¼ŒDrizzle å°†ä» `schema` æ–‡ä»¶å¤¹è¯»å–å¹¶é€’å½’æŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶ä»ä¸­è·å–æ‰€æœ‰ drizzle è¡¨ã€‚  
æœ‰å…³ `drizzle.config.ts` æ–‡ä»¶å’Œä½¿ç”¨ Drizzle è¿›è¡Œè¿ç§»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š[é“¾æ¥](/docs/drizzle-config-file)

```ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: 'postgresql', // 'mysql' | 'sqlite' | 'turso'
  schema: './src/db/schema'
})
```

æ‚¨è¿˜å¯ä»¥ä»¥ä»»ä½•æ‚¨å–œæ¬¢çš„æ–¹å¼å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç»„ï¼Œä¾‹å¦‚ä¸ºç”¨æˆ·ç›¸å…³è¡¨ã€æ¶ˆæ¯ç›¸å…³è¡¨ã€äº§å“ç›¸å…³è¡¨ç­‰åˆ›å»ºç»„ã€‚  
```plaintext
ğŸ“¦ <é¡¹ç›®æ ¹ç›®å½•>
 â”” ğŸ“‚ src
    â”” ğŸ“‚ db
       â”” ğŸ“‚ schema
          â”œ ğŸ“œ users.ts
          â”œ ğŸ“œ messaging.ts
          â”” ğŸ“œ products.ts
```

## å¡‘é€ æ‚¨çš„æ•°æ®æ¨¡å¼

Drizzle æ¨¡å¼ç”±æ‚¨æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“ä¸­çš„å‡ ç§æ¨¡å‹ç±»å‹æ„æˆã€‚ä½¿ç”¨ Drizzleï¼Œæ‚¨å¯ä»¥æŒ‡å®šï¼š  
- å«æœ‰åˆ—ã€çº¦æŸç­‰çš„è¡¨ã€‚  
- æ¨¡å¼ï¼ˆä»…é€‚ç”¨äº PostgreSQLï¼‰  
- æšä¸¾  
- åºåˆ—ï¼ˆä»…é€‚ç”¨äº PostgreSQLï¼‰  
- è§†å›¾  
- ææ–™åŒ–è§†å›¾  
- ç­‰ç­‰ã€‚

è®©æˆ‘ä»¬é€ä¸ªæ£€æŸ¥æ¨¡å¼å¦‚ä½•ä½¿ç”¨ Drizzle å®šä¹‰ã€‚

#### **è¡¨å’Œåˆ—å£°æ˜**

åœ¨ Drizzle ä¸­ï¼Œè¡¨åº”è‡³å°‘å®šä¹‰ 1 åˆ—ï¼Œæ­£å¦‚åœ¨æ•°æ®åº“ä¸­åº”åšçš„é‚£æ ·ã€‚æœ‰ä¸€ä»¶é‡è¦çš„äº‹éœ€è¦çŸ¥é“ï¼Œ  
Drizzle ä¸­æ²¡æœ‰é€šç”¨çš„è¡¨å¯¹è±¡ã€‚æ‚¨éœ€è¦é€‰æ‹©ä½¿ç”¨çš„æ–¹è¨€ï¼šPostgreSQLã€MySQL æˆ– SQLiteã€‚

![](@/assets/images/table-structure.svg)

<CodeTabs items={["PostgreSQL è¡¨", "MySQL è¡¨", "SQLite è¡¨"]}>
```ts copy
import { pgTable, integer } from "drizzle-orm/pg-core"

export const users = pgTable('users', {
  id: integer()
});
```
```ts copy
import { mysqlTable, int } from "drizzle-orm/mysql-core"

export const users = mysqlTable('users', {
  id: int()
});
```
```ts copy
import { sqliteTable, integer } from "drizzle-orm/sqlite-core"

export const users = sqliteTable('users', {
  id: integer()
});
```
</CodeTabs>

é»˜è®¤æƒ…å†µä¸‹ï¼ŒDrizzle å°†åœ¨æ•°æ®åº“æŸ¥è¯¢ä¸­ä½¿ç”¨ TypeScript é”®åä½œä¸ºåˆ—åã€‚  
å› æ­¤ï¼Œæ¥è‡ªç¤ºä¾‹çš„æ¨¡å¼å’ŒæŸ¥è¯¢å°†ç”Ÿæˆå¦‚ä¸‹ SQL æŸ¥è¯¢ã€‚

<Callout>
æ­¤ç¤ºä¾‹ä½¿ç”¨ä¸€ä¸ª db å¯¹è±¡ï¼Œä½†å…¶åˆå§‹åŒ–æœªåœ¨æœ¬éƒ¨åˆ†æ–‡æ¡£ä¸­è¦†ç›–ã€‚è¦äº†è§£å¦‚ä½•è¿æ¥åˆ°æ•°æ®åº“ï¼Œè¯·å‚é˜… [è¿æ¥æ–‡æ¡£](/docs/get-started-postgresql)
</Callout>

\
**TypeScript é”® = æ•°æ®åº“é”®**  
<Section>
```ts
// schema.ts
import { integer, pgTable, varchar } from "drizzle-orm/pg-core";

export const users = pgTable('users', {
  id: integer(),
  first_name: varchar()
})
```
```ts
// query.ts
await db.select().from(users);
```
```sql
SELECT "id", "first_name" from users;
```
</Section>

å¦‚æœæ‚¨æƒ³åœ¨ TypeScript ä»£ç ä¸­å’Œæ•°æ®åº“ä¸­ä½¿ç”¨ä¸åŒçš„åç§°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åˆ—åˆ«åã€‚

<Section>
```ts
// schema.ts
import { integer, pgTable, varchar } from "drizzle-orm/pg-core";

export const users = pgTable('users', {
  id: integer(),
  firstName: varchar('first_name')
})
```
```ts
// query.ts
await db.select().from(users);
```
```sql
SELECT "id", "first_name" from users;
```
</Section>

### é©¼å³°å’Œè›‡å½¢å‘½å

æ•°æ®åº“æ¨¡å‹åç§°é€šå¸¸ä½¿ç”¨ `snake_case` çº¦å®šï¼Œè€Œåœ¨ TypeScript ä¸­ï¼Œå¸¸ç”¨ `camelCase` è¿›è¡Œå‘½åã€‚  
è¿™å¯èƒ½ä¼šå¯¼è‡´æ¨¡å¼ä¸­æœ‰å¾ˆå¤šåˆ«åå®šä¹‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ  
Drizzle æä¾›äº†ä¸€ç§æ–¹æ³•æ¥è‡ªåŠ¨å°† TypeScript ä¸­çš„ `camelCase` æ˜ å°„åˆ°æ•°æ®åº“ä¸­çš„ `snake_case`ï¼Œé€šè¿‡åœ¨ Drizzle æ•°æ®åº“åˆå§‹åŒ–æ—¶åŒ…å«ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚

å¯¹äºè¿™ç§æ˜ å°„ï¼Œæ‚¨å¯ä»¥åœ¨ Drizzle DB å£°æ˜ä¸­ä½¿ç”¨ `casing` é€‰é¡¹ã€‚  
æ­¤å‚æ•°å°†å¸®åŠ©æ‚¨æŒ‡å®šæ•°æ®åº“æ¨¡å‹å‘½åçº¦å®šï¼Œå¹¶å°†å°è¯•ç›¸åº”åœ°æ˜ å°„æ‰€æœ‰ JavaScript é”®ã€‚

<Section>
```ts
// schema.ts
import { drizzle } from "drizzle-orm/node-postgres";
import { integer, pgTable, varchar } from "drizzle-orm/pg-core";

export const users = pgTable('users', {
  id: integer(),
  firstName: varchar()
})
```
```ts
// db.ts
const db = drizzle({ connection: process.env.DATABASE_URL, casing: 'snake_case' })
```
```ts
// query.ts
await db.select().from(users);
```
```sql
SELECT "id", "first_name" from users;
```
</Section>

### é«˜çº§

ä½¿ç”¨ Drizzle ORM æ‚¨å¯ä»¥ä½¿ç”¨ä¸€äº›æŠ€å·§ã€‚åªè¦ Drizzle å®Œå…¨åœ¨ TypeScript æ–‡ä»¶ä¸­ï¼Œ  
æ‚¨å°±å¯ä»¥åƒåœ¨ç®€å•çš„ TypeScript é¡¹ç›®ä¸­ä¸€æ ·è¿›è¡Œä»»ä½•ç¼–ç ã€‚

ä¸€ä¸ªå¸¸è§çš„ç‰¹æ€§æ˜¯å°†åˆ—åˆ†ç¦»åˆ°ä¸åŒçš„ä½ç½®ï¼Œç„¶åé‡å¤ä½¿ç”¨å®ƒä»¬ã€‚  
ä¾‹å¦‚ï¼Œè€ƒè™‘å­—æ®µ `updated_at`ã€`created_at` å’Œ `deleted_at`ã€‚  
è®¸å¤šè¡¨/æ¨¡å‹å¯èƒ½éœ€è¦è¿™ä¸‰ä¸ªå­—æ®µæ¥è·Ÿè¸ªå’Œåˆ†æç³»ç»Ÿä¸­å®ä½“çš„åˆ›å»ºã€åˆ é™¤å’Œæ›´æ–°ã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­å®šä¹‰è¿™äº›åˆ—ï¼Œç„¶ååœ¨æ‰€æœ‰è¡¨å¯¹è±¡ä¸­å¯¼å…¥å¹¶å±•å¼€å®ƒä»¬ã€‚

<Section>
```ts
// columns.helpers.ts
const timestamps = {
  updated_at: timestamp(),
  created_at: timestamp().defaultNow().notNull(),
  deleted_at: timestamp(),
}
```
```ts
// users.sql.ts
export const users = pgTable('users', {
  id: integer(),
  ...timestamps
})
```
```ts
// posts.sql.ts
export const posts = pgTable('posts', {
  id: integer(),
  ...timestamps
})
```
</Section>

#### **æ¨¡å¼**

<Tabs items={['PostgreSQL', 'MySQL', 'SQLite']}>
<Tab>
\
åœ¨ PostgreSQL ä¸­ï¼Œæœ‰ä¸€ä¸ªå®ä½“ç§°ä¸º `schema`ï¼ˆæˆ‘ä»¬è®¤ä¸ºåº”è¯¥ç§°ä¸º `folders`ï¼‰ã€‚è¿™åœ¨ PostgreSQL ä¸­åˆ›å»ºäº†ä¸€ä¸ªç»“æ„ï¼š

![](@/assets/images/postgresql-db-structure.png)

æ‚¨å¯ä»¥ä½¿ç”¨ `pgSchema` ç®¡ç† PostgreSQL æ¨¡å¼ï¼Œå¹¶å°†ä»»ä½•å…¶ä»–æ¨¡å‹æ”¾å…¥å…¶ä¸­ã€‚

ä½¿ç”¨ Drizzle å®šä¹‰æ‚¨æƒ³è¦ç®¡ç†çš„æ¨¡å¼  
```ts
import { pgSchema } from "drizzle-orm/pg-core"

export const customSchema = pgSchema('custom');
```

ç„¶åå°†è¡¨æ”¾å…¥æ¨¡å¼å¯¹è±¡ä¸­  
```ts {5-7}
import { integer, pgSchema } from "drizzle-orm/pg-core";

export const customSchema = pgSchema('custom');

export const users = customSchema.table('users', {
  id: integer()
})
```
</Tab>
<Tab>
\
åœ¨ MySQL ä¸­ï¼Œæœ‰ä¸€ä¸ªå®ä½“ç§°ä¸º `Schema`ï¼Œä½†åœ¨ MySQL æœ¯è¯­ä¸­ï¼Œç›¸å½“äº `Database`ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ `drizzle-orm` å®šä¹‰å®ƒä»¬å¹¶åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ï¼Œä½†å®ƒä»¬ä¸ä¼šè¢« `drizzle-kit` æ£€æµ‹åˆ°æˆ–åŒ…å«åœ¨è¿ç§»æµä¸­ã€‚

![](@/assets/images/mysql-db-structure.png)

ä½¿ç”¨ Drizzle å®šä¹‰æ‚¨æƒ³è¦ç®¡ç†çš„æ¨¡å¼  
```ts
import { mysqlSchema } from "drizzle-orm/mysql-core"

export const customSchema = mysqlSchema('custom');
```

ç„¶åå°†è¡¨æ”¾å…¥æ¨¡å¼å¯¹è±¡ä¸­  
```ts {5-7}
import { int, mysqlSchema } from "drizzle-orm/mysql-core";

export const customSchema = mysqlSchema('custom');

export const users = customSchema.table('users', {
  id: int()
})
```
</Tab>
<Tab>
\
åœ¨ SQLite ä¸­ï¼Œæ²¡æœ‰æ¨¡å¼çš„æ¦‚å¿µï¼Œå› æ­¤æ‚¨åªèƒ½åœ¨å•ä¸ª SQLite æ–‡ä»¶ä¸Šä¸‹æ–‡ä¸­å®šä¹‰è¡¨ã€‚

![](@/assets/images/sqlite-db-structure.png)
</Tab>
</Tabs>

### ç¤ºä¾‹

ä¸€æ—¦æ‚¨æŒæ¡äº†åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬ä¸ºä¸€ä¸ªå®é™…é¡¹ç›®å®šä¹‰ä¸€ä¸ªæ¨¡å¼ç¤ºä¾‹ï¼Œä»¥è·å¾—æ›´å¥½çš„è§†å›¾å’Œç†è§£ã€‚

> æ‰€æœ‰ç¤ºä¾‹å°†ä½¿ç”¨ `generateUniqueString`ã€‚å…¶å®ç°å°†åœ¨æ‰€æœ‰æ¨¡å¼ç¤ºä¾‹ä¹‹åæä¾›ã€‚

<CodeTabs items={['PostgreSQL', 'MySQL', 'SQLite']}>
```ts copy
import { AnyPgColumn } from "drizzle-orm/pg-core";
import { pgEnum, pgTable as table } from "drizzle-orm/pg-core";
import * as t from "drizzle-orm/pg-core";

export const rolesEnum = pgEnum("roles", ["guest", "user", "admin"]);

export const users = table(
  "users",
  {
    id: t.integer().primaryKey().generatedAlwaysAsIdentity(),
    firstName: t.varchar("first_name", { length: 256 }),
    lastName: t.varchar("last_name", { length: 256 }),
    email: t.varchar().notNull(),
    invitee: t.integer().references((): AnyPgColumn => users.id),
    role: rolesEnum().default("guest"),
  },
  (table) => [
    t.uniqueIndex("email_idx").on(table.email)
  ]
);

export const posts = table(
  "posts",
  {
    id: t.integer().primaryKey().generatedAlwaysAsIdentity(),
    slug: t.varchar().$default(() => generateUniqueString(16)),
    title: t.varchar({ length: 256 }),
    ownerId: t.integer("owner_id").references(() => users.id),
  },
  (table) => [
    t.uniqueIndex("slug_idx").on(table.slug),
    t.index("title_idx").on(table.title),
  ]
);

export const comments = table("comments", {
  id: t.integer().primaryKey().generatedAlwaysAsIdentity(),
  text: t.varchar({ length: 256 }),
  postId: t.integer("post_id").references(() => posts.id),
  ownerId: t.integer("owner_id").references(() => users.id),
});
```
```ts copy
import { mysqlTable as table } from "drizzle-orm/mysql-core";
import * as t from "drizzle-orm/mysql-core";
import { AnyMySqlColumn } from "drizzle-orm/mysql-core";

export const users = table(
  "users",
  {
    id: t.int().primaryKey().autoincrement(),
    firstName: t.varchar("first_name", { length: 256 }),
    lastName: t.varchar("last_name", { length: 256 }),
    email: t.varchar({ length: 256 }).notNull(),
    invitee: t.int().references((): AnyMySqlColumn => users.id),
    role: t.mysqlEnum(["guest", "user", "admin"]).default("guest"),
  },
  (table) => [
    t.uniqueIndex("email_idx").on(table.email)
  ]
);

export const posts = table(
  "posts",
  {
    id: t.int().primaryKey().autoincrement(),
    slug: t.varchar({ length: 256 }).$default(() => generateUniqueString(16)),
    title: t.varchar({ length: 256 }),
    ownerId: t.int("owner_id").references(() => users.id),
  },
  (table) => [
    t.uniqueIndex("slug_idx").on(table.slug),
    t.index("title_idx").on(table.title),
  ]
);

export const comments = table("comments", {
  id: t.int().primaryKey().autoincrement(),
  text: t.varchar({ length: 256 }),
  postId: t.int("post_id").references(() => posts.id),
  ownerId: t.int("owner_id").references(() => users.id),
});
```
```ts copy
import { sqliteTable as table } from "drizzle-orm/sqlite-core";
import * as t from "drizzle-orm/sqlite-core";
import { AnySQLiteColumn } from "drizzle-orm/sqlite-core";

export const users = table(
  "users",
  {
    id: t.int().primaryKey({ autoIncrement: true }),
    firstName: t.text("first_name"),
    lastName: t.text("last_name"),
    email: t.text().notNull(),
    invitee: t.int().references((): AnySQLiteColumn => users.id),
    role: t.text().$type<"guest" | "user" | "admin">().default("guest"),
  },
  (table) => [
    t.uniqueIndex("email_idx").on(table.email)
  ]
);

export const posts = table(
  "posts",
  {
    id: t.int().primaryKey({ autoIncrement: true }),
    slug: t.text().$default(() => generateUniqueString(16)),
    title: t.text(),
    ownerId: t.int("owner_id").references(() => users.id),
  },
  (table) => [
    t.uniqueIndex("slug_idx").on(table.slug),
    t.index("title_idx").on(table.title),
  ]
);

export const comments = table("comments", {
  id: t.int().primaryKey({ autoIncrement: true }),
  text: t.text({ length: 256 }),
  postId: t.int("post_id").references(() => posts.id),
  ownerId: t.int("owner_id").references(() => users.id),
});
```
</CodeTabs>

**`generateUniqueString` å®ç°ï¼š**  
```ts
function generateUniqueString(length: number = 12): string {
  const characters =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
  let uniqueString = "";

  for (let i = 0; i < length; i++) {
    const randomIndex = Math.floor(Math.random() * characters.length);
    uniqueString += characters[randomIndex];
  }

  return uniqueString;
}
```

#### æ¥ä¸‹æ¥åšä»€ä¹ˆï¼Ÿ  
<br/>
<Flex>
  <LinksList 
    title='ç®¡ç†æ¨¡å¼'
    links={[
        ["åˆ—ç±»å‹", "/docs/column-types/pg"], 
        ["ç´¢å¼•å’Œçº¦æŸ", "/docs/indexes-constraints"],
        ["æ•°æ®åº“è§†å›¾", "/docs/views"],
        ["æ•°æ®åº“æ¨¡å¼", "/docs/schemas"],
        ["åºåˆ—", "/docs/sequences"],
        ["æ‰©å±•", "/docs/extensions/pg"],
      ]}
  />
  <LinksList 
    title='ä»é›¶åˆ°è‹±é›„'
    links={[
        ["æ•°æ®åº“è¿æ¥", "/docs/connect-overview"], 
        ["æ•°æ®æŸ¥è¯¢", "/docs/data-querying"], 
        ["è¿ç§»", "/docs/migrations"], 
      ]}
  />
</Flex>