---
title: DrizzleORM v0.29.2 å‘å¸ƒ
pubDate: 2023-12-25
description: åœ¨ planescale å…³ç³»æµ‹è¯•ä¸­å®ç°äº†æ”¹è¿›ã€‚ä¿®æ­£äº†ç©º PgArrays çš„å­—ç¬¦ä¸²è½¬ä¹‰ã€‚ä¿®æ­£äº† SQLite ä¸­ exists å‡½æ•°çš„è¯­æ³•é”™è¯¯ã€‚ç¡®ä¿åœ¨ AWS Data API ä¸­æ­£ç¡®å¤„ç†æ—¥æœŸã€‚è§£å†³äº† Hermes mixins æ„é€ å‡½æ•°é—®é¢˜ã€‚
---

## ä¿®å¤: 

- å¯¹ planescale å…³ç³»æµ‹è¯•è¿›è¡Œäº†æ”¹è¿› ([#1579](https://github.com/drizzle-team/drizzle-orm/pull/1579))
- ä¿®å¤äº†ç©º PgArrays çš„å­—ç¬¦ä¸²è½¬ä¹‰é—®é¢˜ ([#1640](https://github.com/drizzle-team/drizzle-orm/pull/1640))
- ä¿®å¤äº† SQLite ä¸­ exists å‡½æ•°çš„è¯­æ³•é”™è¯¯é—®é¢˜ ([#1647](https://github.com/drizzle-team/drizzle-orm/pull/1647))
- åœ¨ AWS Data API ä¸­æ­£ç¡®å¤„ç†æ—¥æœŸ
- ä¿®å¤äº† Hermes mixins æ„é€ å‡½æ•°é—®é¢˜

## ESLint Drizzle æ’ä»¶, v0.2.3

```bash copy
npm i eslint-plugin-drizzle@0.2.3
```

ğŸ‰ [ESLint] æ·»åŠ å¯¹å‡½æ•°çš„æ”¯æŒå¹¶æ”¹å–„é”™è¯¯æ¶ˆæ¯

- å…è®¸ä»å‡½æ•°ä¸­è·å–æˆ–æ£€ç´¢ Drizzle å¯¹è±¡ï¼Œä¾‹å¦‚
- åœ¨é”™è¯¯æ¶ˆæ¯ä¸­æ·»åŠ äº†æ›´å¥½çš„ä¸Šä¸‹æ–‡ä¿¡æ¯

æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ [æ–‡æ¡£](https://orm.drizzle.team/docs/eslint-plugin)

## æ–°çš„é©±åŠ¨ç¨‹åº

**ğŸ‰ Expo SQLite é©±åŠ¨ç¨‹åºç°å·²å¯ç”¨**

è¦å¼€å§‹ä½¿ç”¨ [Expo SQLite é©±åŠ¨ç¨‹åº](https://orm.drizzle.team/docs/get-started-sqlite#expo-sqlite)ï¼Œéœ€è¦å®‰è£… `expo-sqlite` å’Œ `drizzle-orm` åŒ…ã€‚

```bash copy
npm install drizzle-orm expo-sqlite@next
```

ç„¶åï¼Œå¯ä»¥åƒè¿™æ ·ä½¿ç”¨å®ƒ:

```ts copy {4,6}
import { drizzle } from "drizzle-orm/expo-sqlite";
import { openDatabaseSync } from "expo-sqlite/next";

const expoDb = openDatabaseSync("db.db");

const db = drizzle(expoDb);

await db.select().from(...)...

// æˆ–è€…

db.select().from(...).then(...);

// æˆ–è€…

db.select().from(...).all();
```

å¦‚æœè¦ä½¿ç”¨ Drizzle è¿ç§»ï¼Œè¯·æ›´æ–° babel å’Œ metro é…ç½®æ–‡ä»¶ã€‚

1. å®‰è£… `babel-plugin-inline-import` åŒ…ã€‚

```bash copy
npm install babel-plugin-inline-import
```

2. æ›´æ–° `babel.config.js` å’Œ `metro.config.js` æ–‡ä»¶ã€‚

```ts filename="babel.config.js" copy {6}
module.exports = function(api) {
  api.cache(true);

  return {
    presets: ['babel-preset-expo'],
+   plugins: [["inline-import", { "extensions": [".sql"] }]]
  };
};
```

```ts filename="metro.config.js" copy {6}
const { getDefaultConfig } = require('expo/metro-config');

/** @type {import('expo/metro-config').MetroConfig} */
const config = getDefaultConfig(__dirname);

+config.resolver.sourceExts.push('sql');

module.exports = config;
```

3. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­åˆ›å»º `drizzle.config.ts` æ–‡ä»¶ã€‚

```ts copy
import type { Config } from 'drizzle-kit';

export default {
	schema: './db/schema.ts',
	out: './drizzle',
    dialect: 'sqlite',
	driver: 'expo',
} satisfies Config;
```

åˆ›å»ºå®Œ schema æ–‡ä»¶å’Œ drizzle.config.ts æ–‡ä»¶åï¼Œå¯ä»¥åƒè¿™æ ·ç”Ÿæˆè¿ç§»:

```bash copy
npx drizzle-kit generate
```

ç„¶åï¼Œæ‚¨éœ€è¦ä» `./drizzle` æ–‡ä»¶å¤¹çš„ `migrations.js` æ–‡ä»¶ä¸­å¯¼å…¥åˆ°æ‚¨çš„ `App.tsx` æ–‡ä»¶ä¸­ï¼Œå¹¶ä½¿ç”¨ `useMigrations` æˆ– `migrate` å‡½æ•°ã€‚

```ts copy {4,11}
import { drizzle } from "drizzle-orm/expo-sqlite";
import { openDatabaseSync } from "expo-sqlite/next";
import { useMigrations } from 'drizzle-orm/expo-sqlite/migrator';
import migrations from './drizzle/migrations';

const expoDb = openDatabaseSync("db.db");

const db = drizzle(expoDb);

export default function App() {
    const { success, error } = useMigrations(db, migrations);

    if (error) {
        return (
            <View>
                <Text>Migration error: {error.message}</Text>
            </View>
        );
    }

    if (!success) {
        return (
            <View>
                <Text>Migration is in progress...</Text>
            </View>
        );
    }

    return ...your application component;
}
```
